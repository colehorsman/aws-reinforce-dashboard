# AWS re:Inforce 2025-Implementing incident response with AWS Well-Architected best practices (COM324)

**Video Link:** [Watch on YouTube](https://www.youtube.com/watch?v=C7olLweV2Kg)

## Video Information
- **Author:** AWS Events
- **Duration:** 15.8 minutes
- **Word Count:** 1,639 words
- **Publish Date:** 20250620
- **Video ID:** C7olLweV2Kg

## Summary
Masanori Yamaguchi presents a comprehensive approach to implementing incident response based on AWS Well-Architected security pillar best practices. The session emphasizes that security incidents are inevitable and preparation is crucial for effective response. The presentation focuses on the critical phases of containment and acquisition, providing a structured playbook for essential incident response tasks that can be automated using AWS Step Functions to ensure reliable and repeatable execution during high-stress security incidents.

## Key Points
- Security incidents can happen at any time and preparation is the key to fast and accurate response - you must always be ready before an incident occurs
- Containment and acquisition are the most critical phases of incident response - attacks must be stopped from spreading and key data must be collected before it's lost
- AWS provides comprehensive incident response guidance but information is scattered across multiple documents including security pillar, incident response user guide, and prescriptive guidance
- Essential containment tasks include: tagging instances under investigation, enabling termination protection, isolating instances with security groups, and detaching from auto-scaling groups
- Essential acquisition tasks include: taking EBS volume snapshots with encryption, collecting instance metadata, capturing memory dumps, and performing live response analysis
- Automation is crucial for incident response because manual execution under pressure leads to mistakes - AWS strongly recommends automating incident response tasks
- Step Functions provides better visibility and workflow orchestration compared to Lambda for multi-step incident response processes
- Parallel execution capabilities in Step Functions can save critical time during incidents by running multiple containment and acquisition tasks simultaneously

## Technical Details
- Complete incident response state machine performs 9 automated steps: instance tagging, termination protection, metadata collection, and parallel execution of 6 containment/acquisition tasks
- Containment workflow includes: EBS snapshot creation with encryption, setting delete-on-termination to false, detaching IAM instance profiles, removing from auto-scaling groups, deregistering from target groups, and applying isolation security groups
- Instance isolation involves detaching all existing security groups and attaching an isolation security group with no inbound or outbound rules to cut off all network traffic
- Error handling and catching mechanisms are built into each step - if tagging fails, the state machine stops with error messages rather than continuing
- Future implementation plans include memory dump capture and instance store volume backing using AWS Systems Manager Run Command
- Step Functions workflow studio provides visual workflow building without requiring programming skills, making it easier to maintain than Lambda-based solutions
- Parallel state execution in Step Functions allows simultaneous execution of snapshot creation, IAM profile detachment, auto-scaling removal, and security group isolation
- The solution is available on GitHub for customization and deployment into different AWS environments with proper IAM permissions and resource configurations

## Full Transcript

Hello. Uh, thank you for, uh, coming to, uh, this session. Uh, hello, my name is Masanori Yamaguchi. I am a, uh, head of community hero. Uh, I work, uh, as an executive officer at 4 division. Today, I talk about how to implement our arched uh in response or AWS. Here is today's agenda. First, my security insurance response matters. Uh, why I, sorry, why insecurity resource matters? Understanding the risk in the starting point. Next, the importance of preparing for it in advance. Preparation is key to fast and accurate response. Then how to organize and prepare response procedure. This includes essential task for containment and acquisition. Finally, how to automate the playbook to ensure reliable and repeatable execution during an incident. AWS work framework has 6 pillars. Today, we focus on the security pillar. It has key areas like IDT and access management, detection, in uh infrastructure, and also initiate response. Let's think again. Why is most important? We cannot control when a security problem happens. It can happen any time, just like an accident. That means it's not maybe someday. It may be today That can happen at any time. When it happens, your company is in trouble. Sometimes it's a big crisis. So we must act fast. We must find the problem and start recovery. That is why we must always be ready. The sec security pillar explains the life cycle of insect response. It starts with preparation. Then comes detection, analysis, contentment and recovery. This shows us one important thing. We must be ready before an incident happens. Being prepared is the key to taking the right action when something goes wrong. has any impact. Here are 4 steps needed to recover from an incident. Every step in incident response is important, but containment and acquisition are the most critical. The attack must be stopped from splitting. Key data must be collected before it's lost. Attackers may try toe evidence or expand their access. Quick and accurate action is essential. To confirm re recovery is complete. Data is also needed to clearly define the scope of recovery. That's why commitment and acquisition must be done early and reliably. Let's take a look at how continuity is actually done. AWS provides many documents about containment. But information is spread out. You can find guidance in the security pillar, the inset response user guide, and press click click guidance. So what do these documents say? They list many important actions. Isolate the instance, loaded credentials, stop compromise resources, remove from auto-scale and load balancer. Restoring access with security group and resource policies, very important. Now, let's also look at acquisition. This area is also well documented. Guidance includes how to take snapshots, capture memory, and collect logs. The challenges is the same. Information is scattered across many documents. There are even more documents available on acquisition. Some of them are published only in specific language. Having lots of documents is not, uh, but so having lots of documents is not a bad thing, very good, good thing. But when information is spread out across many sources, it can take time to find the exact steps needed, especially uh during an incident. That can be concerned. Based on these documents, with uh I summarized uh common acquisition steps. Enable termination protection, take snapshot of each Ebis volumes, uh, collect instance metadata, capture memory, perform live response, uh, disk memory logs, and etc. Let's leave you the key point and the challenge of insect response so far. First, preparation is essential, and containment and acquisition must be done quickly and accurately. The challenges is that the required steps are documented, but not in one place. Information is spread out multiple documents. To address this, a set of common essential tasks has been extracted from those documents. These tasks are shared across many scenarios and are the foundation for building a reliable playbooks. Here are the uh the essential tasks for containment. These tasks are divided into 5 steps. Each step, uh, each step is designed to stop the incident from spreading and protect the environment. Uh, one of the targets, the instance to, uh, indicate it's and, uh, investigation, uh, to, uh, the AWIM that profile or uh and uh that isolation Security group. Uh, next, uh, here's essential task for acquisition. These tasks are grouped into 4 key steps. Uh, there are to support effective investigation and recovery. Let's think about how to prepare a playbook for these tasks. Manual execution is possible, step by step. So it can also be used to support the process. But which option is the best? The answer is automation. Next, the reason why automation is such a powerful choice will be introduced. Automation is very important in response. When an incident that happens, we are under very strong pressure. We will stress and we must act fast. In this situation, it's easy to make mistakes. Automation helps us avoid errors. Less human work means fewer mistakes. It's also save time and reduce risk. That's why AW strongly recommends automating instant response tasks. This is AWS prescriptive guidance. It provides best practice for automation, both in this response and forensics tasks. It helps design reliable and repeatable process during high situation. The guidance mainly focuses on autom automation uh using Adapt Lambda. Next several automation uh option will be introduced. Now, let's look at services we can use for automation. There are many options like AWS lambda, Systems Manager, and step functions. In the next slide, we will focus on two popular choices. Lambda, which is used in AW split scripted guidance. And the function which support workflow orchestration. Lambda is powerful and very flexible. But it needs programming skills like Python, No GLS or other programming languages. It can also be hard to read and maintain. The function is easier for uh many teams. You don't need to write code. You can see and build the uh workflow visually with workflow studio. It gives better visibility and is easier to manage, especially where multiple steps are involved. Right now I know At the time, uh, there was no situation using only step function to automate in response. So I decided to build one. This state machine runs contestant, uh, acquisition step automatically. The steps are based on AW well architect framework and other official documents. I'll leave you those materials and pick up the key actions for response. They turned them into a working solution. Here, the 9th step, this state machine performs. Each step is part of the containment and acquisition process. Together, they help us isolate the instance and collect key data. In the next slide, I'll walk you through each step briefly. I'm The first step is to add tag to the instance. The tag is under investigation. This helps other teams know instance is uh being handled. It's a small step, but very beautiful. If the tag cannot be set, the set machine will stop. It's shown an error message and exists. When automa automating multiple steps, uh error catching and handling are very important. Next, the instance must be protected from accidental television. Terminated friction and protection is enabled, and the shutdown behavior is set to stop. These settings prevent the incident from being terminated during response operations. Next, instance metadata is collected. This information helps identify the system state at the time of the incident. Key details such as the instance ID, instance type, instance address, BPC and submitted IDs, executive group, and launch time are recorded. This value provide important context for investigation. Oh Now, task 4 to 9 run at the same time. This saves time during an incident. Par execution uh is one of the strengths of step functions. For party execution, uh, I use a party state in state functions. Inside these steps, each task run independently. Snapshots are created for uh attach uh each EB volumes. Encryption must be enabled. And an investor tag is added for identification and tracking. Next, the set delete on termination attribute 24 or EBS volumes. This ensures that volumes are not deleted when the instance is stopped or terminated. I. Next, detach IM instance profile. This is critical security step. Detaching the IM instant profile blocks, access to other AW services. This prevents the compromise instance from causing further damage. Also, uh, the instance is detached from the auto scaling group. This prevents automatically automatic termination or replacement. It also helps maintain the desired number of healthy instances. If the instance is part of a target group, uh, it should be the registered. This stops, uh, this stops traffic from the load ver. And prevents the compromising stuff from responding to request. All existing security groups are detached from the instance. I answer it isolate, an isolation security group is then attached. This group has no inbound or outbound rules. Effectively cutting off all network traffic. How In some cases, uh, capturing a memory dump or backing instances store volumes may be required. This can be done using AW System Managerran command. These steps are currently planned for future implementation. OK. OK, uh let's review what we covered today. Security incidents can happen anytime. So preparation is very important. During an incident, automate helps learn key steps quickly and correctly. Choose a method that is easy to maintain and not tied to one person. The set machine for essential in response task can help during a very response uh into your environment. OK. You can play the same machine, uh, I introduced today. It's available on GitHub. Please feel to use it or customize it for your environment. Uh, thank you for your time. Uh, I hope this content, uh, help for, uh, your work or, uh, your team. Uh, thank you.
