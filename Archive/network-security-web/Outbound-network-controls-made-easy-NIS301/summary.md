# AWS re:Inforce 2025 - Outbound network controls made easy (NIS301)

**Video Link:** [Watch on YouTube](https://www.youtube.com/watch?v=EJEly17XMQ8)

## Video Information
- **Author:** AWS Events
- **Duration:** 34.5 minutes
- **Word Count:** 5,843 words
- **Publish Date:** 20250619
- **Video ID:** EJEly17XMQ8

## Summary
This session focused on simplifying egress security strategies using AWS Network Firewall and Route 53 Resolver DNS Firewall. The speakers explained how to implement layered network defense through a combination of denial lists, generous allow lists, and proper egress controls. They demonstrated the new automated domain list feature and AWS threat intelligence integration to help customers build effective outbound network controls without hindering legitimate application behavior.

## Key Points
- **Two Egress Paths**: Protect both IP-based (Network Firewall) and recursive DNS paths (Route 53 Resolver DNS Firewall)
- **Defense Strategy**: Start with denial lists, then implement generous allow lists, finally move to strict allow lists
- **AWS Threat Intelligence**: New proprietary threat intelligence from tens of thousands of global honeypots integrated into Network Firewall
- **Automated Domain Lists**: Traffic analysis mode generates 30-day domain reports without logging setup
- **Generous Allow List Approach**: Combine default deny with broader allowances (e.g., .gov, .edu domains) for safe operations
- **Multiple Layers**: AWS managed rules, custom denial lists, geographic filtering, protocol validation
- **New Features**: Multiple VPC endpoints support, native dashboard, reduced costs for distributed architectures
- **Best Practices**: Allow listing over denial listing, iterative approach, leverage cloud workload predictability

## Technical Details
- **Network Firewall Capabilities**: Application-aware rules, IDS/IPS, deep packet inspection, domain filtering
- **Threat Intelligence Sources**: Proofpoint partnership, AWS proprietary honeypot network, customer open source feeds
- **High-Risk Indicators**: Strange geographic IPs, high-risk top-level domains, direct IP communications, protocol mismatches
- **Geographic Filtering**: Block high-risk countries based on workload region and business requirements
- **Protocol Controls**: HTTP only on port 80, TLS only on TCP 443, block unusual port combinations
- **Automated Reports**: Domain access frequency, unique source counts, first/last access timestamps for policy decisions
- **RegEx Support**: Pattern matching for domain allowlisting, subdomain wildcards, flexible rule creation
- **Cost Optimization**: Shared compute across VPCs, secondary endpoints reduce hourly charges

## Full Transcript

So if you're here we are assuming you're fairly comfortable with some of our networking concepts, security concepts and uh fairly comfortable with some of our security services and you're really here to learn what we've launched ahead of reinforced to help you simplify your egress security journey. Real quick, my name is Sofia Aluma Santos. I lead our network and application protection, uh, business development strategy inside of our security organization, and I'm joined by my colleague Jessie Leitch, uh, senior, uh, security, uh, solution architect here at AWS and overall network security extraordinaire. So we've got a jam packed agenda for you. We'll touch on real quick some of the industry challenges that we hear when we're talking to folks at scale from a network perspective we'll touch on, you know, what we see, uh, from a customer journey perspective we'll walk through why egress security matters as uh a way to implement layered network defense in depth. We'll do a quick primer on the native security services that are in scope for the discussion that we really wanna unpack from a guiding principles, best practices, and new capabilities that we've launched here this week. We'll walk through, uh, the idea of setting up your egress strategy according to some of our best practices as we've come to know them when we're working with our customers and uh we'll wrap it up. So real quick, What are teams and network security teams telling us uh as they implement their overall network architecture? Obviously there's an ever evolving need to keep up with the threat landscape as it evolves as it matures as it changes all this in hand with having to meet compliance regulations companies have a complexity of, you know, architectures and presence around the globe, so having to meet global. Uh, data sovereignty regulations or in country type of compliance geo fencing federal industry type of of compliance needs all of this takes a toll on teams from a manual overhead resource bandwidth and skill perspective as they work to. Set up their network strategy they have to see how to meet all of these needs but also how to minimize potential blast impact and how to set you know their network across from to minimize potential lateral movement or uh as we'll really unpack here minimize uh a potential for any outbound unauthorized outbound connections. So what is egress? Why are folks really spending and choosing to invest proactively in setting an egress strategy? We'll see that it falls around kind of 3 tenants, 3 themes. The first of which is prevention. So we're seeing a potential exponential rise in ransomware targeting for uh data exfiltration and the idea comes from, you know, meeting the importance and meeting the the minimization of a potential for data exfiltration when we unpack this idea of a software supply chain security risk. We see this if you think of some of your applications as building blocks as Lego blocks, we know that our dev teams may not have built all of this and are leveraging open source libraries and parts of code to build towards that application. We find that our dev teams might not always have a tight control over all of this type of code and we, we have to know, uh, you know how to proactively work against a potential vulnerability. We saw this in log 4J where some this this specific open source software uh had to call out to the Internet to a command and control center to execute a malicious payload and then be able to execute from their unauthorized connections and uh execute uh unauthorized actions. So all of this comes into play and if we are able to proactively uh set those egress uh robust controls there even if we find ourselves at a potential risk for, you know, the next log 4 J. These are not we we minimize that blast impact uh and reduce that effectiveness of that attack if it's not able to make a connection to the outside. The second piece is visibility. So when you set these firewall policies and these rules, when they are triggered, you'll see this gives us additional enrichment context in our logs so we can see if we're seeing this a lot we can then troubleshoot and analyze if there's something larger in from an attack path perspective or a threat uh perspective if there's something larger at play. And on the other side of that if we expect something to be frequently triggered but we're not seeing that it gives us clues for potential misconfigurations we're able to see if something maybe needs tweaking or scoping down. And all of this we wanna make sure we're seeing the larger context from a typical web application architecture where you know you're seeing your traffic and you're uh implementing your defense in depth from starting in that ingress path so you're maybe setting your your WAF your web application uh firewalls to implement those protections against web exploits. What we're really digging into today is these egress paths and what we wanna focus on is I wanna make sure we touch on and you you take away with is that there's two paths out to the internet. We have, you know, I think you, everyone's fairly familiar with the traditional IP filtering route, maybe the net gateway out to the Internet gateway, but it's important to remember that there's the recursive DNS path that is a a second path and from a security service scope. These are the two services that are here to protect those two paths. So for that recursive DNS path we have the Amazon Route 53 resolver DNS firewall essentially helps you protect and execute custom actions based on the domains that you want to trust or block. And then secondly we have AWS network firewall so that's that's gonna be this is gonna be the core of of what we're gonna talk about today and some of the new launches that we've launched this week and ahead of of uh the the conference to help you simplify that egress journey that I've been discussing. So real quick, what is AWS network firewall? This is a highly available, customizable, fully managed service that allows you to implement application aware rules, IDS IPS, deep packet inspection, domain filtering to deploy essential network protections for your VPCs. And one last piece. So if you're the CIA red teams publish these best practices and guidelines to really harden your network security, and a key piece that they mention is executing effective egress controls. If you talk to a red teamer, they'll tell you if you wanna make my job difficult, it's set up effective egress strategies. And what's more is this idea of allow listing. So we'll walk through that today. Uh, and I've walked through the why, why this is important, and I'll hand it off to Jessie who will walk us through the how. Thanks, Sophia. Hi everyone, I'm Jessie Leppich. I'm a security SA with AWS. I work with a lot of our largest customers on egress security deployment strategies, best practices, and really helping them get to where they want to be, which is how do we reduce risk across our network in a way that's safe and not going to hinder our applications legitimate behavior. So thank you very much for choosing to spend time on this important topic. We do see customers getting a lot of value out of even some very minimal egress security controls end up having outsized value. So before we dive in, we try to keep in mind. That while we're thinking about egress security, there's a lot of different security controls we could spend time on, right? And so we don't want to overindex on any single control we wanna make sure that we're spreading our engineering time and being smart about how we invest that. So as we think about that, we, we try to focus on our what are the highest value items that we can do first, etc. and then not get too hung up on trying to make that perfect on day one, right? We wanna take an iterative approach, so I put waF on here. It's a common area that customers are intuitively know if I have an application published to the internet, I probably wanna putAF on it. That's great. You could spend a lot of time trying to make your waF configuration perfect. It's likely that it makes more sense to move on to other security controls, so we really want to take an approach that considers the full spectrum of comprehensive defense in depth security across all the controls, and we'll find that these in depth complimenting each other very well. So the first thing that comes up with customers is they will say should I use an allow list or a denial list on my egress controls and this is very common. Allow list sounds very appealing from a security perspective. Denial list tends to be really easy, so which one should I use? Well, in real world deployments, you probably wanna use both, and so we'll walk through how to prioritize that, how to think about which tools, which strategies help first. And if you think about this, you're probably very familiar with least privilege from the identity side. I am you go into it and you configure uh privileges for certain, um, access patterns across certain services and all of that is allow list. I'm not just letting anything happen across my identity, right? I'm narrowly saying these things can happen and maybe within the service it's a little bit wider than this other service. And then I also have this other construct called SCPs that are my denial list and so both of these together can complement each other to have the list of things you're allowing and then some guard rails on top of that to say even within what is allowed there's certain scenarios where I want to maybe deny certain things that uh that might be higher risk and so taking this approach and adopting it and applying it to egress network connections is really what we uh are are working towards with with customers. If you think about the identity, we would never say that every identity or any identity can do anything they want across everything right, but oftentimes as we think about egress security on the network that ends up being the starting point. So we do believe it's important to start early and to start getting those controls in place and getting value out of that. In the cloud we have a particular advantage in that most workloads are fairly predictable. The network behaviors that come out of those workloads we usually know kind of like 80-90% on day one before we even examine the logs. We kind of know what they need to do to perform their job and so we, we are utilizing that advantage to be able to say, hey, quickly we can put in some guard rails to make sure that we're reducing risk in a way that's safe for those applications. In terms of guiding principles, leveraging multiple layers of defense is a big one. We want to use these security controls to complement each other, looking for quick wins, not getting too hung up on trying to make in every individual configuration perfect on day one, but taking an iterative approach where we do the basics we take. Advantage of the security risk reduction of those basics and then we move on further along the journey to try to tighten things down, make things more narrow, more secure without impacting the legitimate application behaviors and then this big one that I'll talk quite a bit about is this idea of a generous domain allow list. This is a default deny strategy that reduces a lot of risk but in a way that helps customers be able to manage that firewall policy easily over time. So we'll walk into a little bit deeper these three different modes here. So starting with denial list, denial list is very common because it's easy to do within network firewall. We have, uh, AWS managed signatures, managed rules that we keep up to date on your behalf. We work with our partners like Proof Point to add additional, uh, threat intelligence to these rules, and we also, uh, announced today that we have our own proprietary AWS security we're integrating here as well that I'll. These tend to be easy to implement very quick, fast, easy, low risk in terms of blocking legitimate connections. And they add a lot of context to your logs. So if you see something being blocked through the denial list AWS managed rules, not only do you know this thing was blocked, but it's gonna give you a description as to why it's being blocked. And so your incident responders, your threat hunters can look for these signals, can combine these signals and use those to be able to prioritize work which workloads maybe they need to spend more time investigating. There is sort of a downside to denial list, right? It's not perfect. It does, uh, not reduce risk as much as an allow list, so we want to continue, we want to use this as a starting point, but we wanna continue along the journey once we get this in place and build on that. But how do we think about making denial listing easier, better, more effective? Were recently announced, uh, today actually that we are integrating our own proprietary AWS threat intelligence into network firewalls denialist capabilities. So now you have threat intelligence from our partners like Proof Point. You might have your own open source threat intelligence that you wanna integrate, and you can take advantage of AWS native proprietary threat intelligence. So where does this threat intelligence come from? We have a large honeypot presence across the globe in AWS environments that look to the outside like their workloads directly adjacent to production workloads. So from the outside they're emulating these services. We have tens of thousands of decoys stationed around the globe. Where we're collecting these signals, collecting, uh, what's happening across the globe, what types of threats, what types of scams, vulnerabilities, exploits are attackers attempting and these service services emulate hundreds of different individual services that may look to the outside to be vulnerable. So for example we might spin up a WordPress site when it's discovered and uh probed from the outside it might appear that it's totally you know uh vulnerable to certain things and then we watch to see what is the attacker going to try to do to exploit that vulnerability and then we figure out what are the. IOCs indicators of compromise that we want to extract from that and make sure that all of our AWS customers can take advantage of this proactively blocking those things on their network before they ever may even be scanned for it. And you'll see over time we'll integrate more and more of this threat intelligence across all of our native AWS security services as we think through deny listing it's very common to also leverage geographic IP filtering so within a network firewall you can use geo filtering to say, hey, my workloads don't necessarily need to be able to reach out to certain countries that might be higher risk, uh, IP destinations. This is gonna be different for every customer, right, uh, but again based on the the region of where the workloads exist, we can usually use that as a key to say hey, they probably need access to other things in this region and maybe not access to certain high risk uh GO spaces that we're aware of. And then we move on to this idea of allow listing and in in many cases we'll see customers jump straight to this. They know that allow listing is very effective from a security perspective, um, and so it's very enticing to start here we actually recommend you not start here. Start with the denial list first and then start to turn on allow listing monitoring and building off of that. But we do have some customers that will that will say, hey, I explicitly want to be here. I need to get to a strict allow list for certain reasons, compliance concerns, etc. we can help with that as well and so I'll show you tooling that helps you get there, but there are considerations for this. It does reduce the most security risk because the scope of what is possible is now very narrow just by default. Um, it can, can help teams enforce change control procedures. So some of our customers will say if any network behavior, any application behavior changes across my network, that should have to be, uh, approved through our change or change control process and so they'll proactively block those things until a ticket is put in and approved and documented and so strict allow list can really help with that. It's not usually a good place to start. It can be cumbersome at first. Um, it can be challenging to manage these rules over time, so you do want to, you know, be mindful of these considerations because it does have a higher probability of blocking legitimate connections. So if you're going to implement this, you really need to stay on top of and have mechanisms in place internally to show you that, hey, something new popped up on the list and we need to evaluate that. So We also, uh, moving on from this allow list idea we know that allow list can reduce a lot of risk surface, but the question is how do we use it in a safe way to where we don't have to worry about legitimate applications being blocked, um, and so we kind of have this idea of a generous allow list that gives some wiggle room for our applications but in a safe way. So combining the idea of the denial list with a more open, a more generous allow list can be very effective because you get the best of both worlds, right? I get this default deny policy which which says that a lot of things are just gonna be blocked by default. I get to know that my denial list is in place and so if I happen to make my allow list maybe a little bit broader, uh, if something bad happens inside of that allow list spectrum, the denial list rules are gonna kick in and protect me. And so this helps us get to a spot where we feel more safe and comfortable spreading and opening up the allow list to allow certain safe things with reject right so where I can say there's certain domains that maybe the sub domains are OK, right? And so we'll walk through some strategies there. This has excellent security risk reduction and it's much, much easier to manage over time and so again we would make sure that we're taking a mindset of iterative approach we'll make this better over time, but let's start with a denial list let's then move on to a very generous allow list. Let's look at our logging and see are the places where we need to scope that down further. Does that sound familiar to anyone who's maybe worked on identity? This is a similar approach that we take with identity policies where we say, hey, you know, at first, especially in a dev environment, I want to allow maybe a wider spectrum of what can happen, document it, uh, log it, and then later scope those policies down, especially if they're gonna be moved into production. All right, so what does this really look like? At a high level conceptually we tend to build our generous allow list and denial list out like this where at the top we would have our AWS managed rules that are helping with the denial list so this is threat intelligence both from our partners and from active threat defense, which is uh threat intel that comes from our internal honey pots. Again kept up to date for you so it's, it's our job to make sure that as new threats are evolving as new indicators are discovered we automatically very quickly add those to your blocked rules if you're taking advantage of the managed rules. Blocking those high risk known bad destinations right then we would move on from there to start putting in some custom denialist rules high risk GOIP locations, um, I can, you know, name the ones that kind of show up in the news you have some ideas there, um, but you would be surprised how effective this can be. I think as security professionals we would look at this and go, well, you know, maybe the attacker changes the geo that's possible they could do something like that. But in the real world we see time and time again that they do the thing that's easiest and oftentimes those things have indicators like uh you know, easy to identify, easy to block things like strange geos. Same for high risk top level domains so there's great research out there that shows there's certain top level domains that are much, much higher risk than others and so we can leverage that again one of the advantages we have in the cloud is the workloads are typically fairly narrow in their behavior. Um, it's usually fairly predictable in a lot of cases it's not human humans doing, you know, a lot of different things. It's an application doing specific things over and over again and so. Top level domains that are known to be high risk are fairly easy and safe to put blocks in really early. Same with high risk ports. There are certain ports that, you know, uh, Sofia mentioned log for J where there was a common set of ports used by log for J exploitation, and those ports are basically used by nothing else legitimately. So why not put those on our denial list. Even if you decide that you don't want to deny these things, it's important to at least have rules in place to alert on these things where you could take that context, take that enrichment into your, your SIM, and have your incident responders be able to have more information to make good decisions off of. Direct to IP communications is another one we see in common um exploitation is that a connection, a legitimate connection usually is gonna reach out to a domain, right? But time and time again we'll see these pieces of malware and C2 implants that reach directly out to not a domain but an IP address and in many cases they're reaching out to it over a strange port number like a high risk port number or it's an IP address that exists in a GEO. And so you can see if you place these things together they complement each other and it can give you a lot of risk reduction uh very safely and easily. Important protocol mismatch is another one we commonly see. So this is where executable pieces of malware or command and control software are are using HTTP but maybe over a high port number, a weird port number, not port 80, right? So we can write firewall rules with a network firewall that say if you see HTP traffic it has to be on Port 80. No other port should be able to accommodate that traffic if you want. If you see TLS traffic, it has to be over TCP 443. We can easily and safely write these rules, uh, to lock those things down. So why are we spending so much time on the denial list when I said a generous allow list, right? Well, the two complement each other and. Having these effective denialist policies gets me to a position where I can feel more comfortable having a wider generous allow list. Now how wide should it be? That's always gonna be uh specific to each customer, what their concerns are, what their criticality is of the of the applications, but some things we've seen customers do is maybe allow list all of uh dot gov. This seems pretty wide, right? As a security person that I might. Initially cringe a little bit to see something like that because I know with inside of that maybe there could be something bad right but keep in mind we're not just saying willy nilly anything can get to every .gov site. What we're saying is here if you've already passed through all these other checks above and you're trying to get to.gov. Then it's probably safe enough for now that we'll go ahead and allow it and take an iterative approach if we want to change this policy later log things, and then, uh, narrow the scope down later on we certainly can.edu same way maybe there's AWS service APIs I want to allow all access to. Um, I can do some slight regX here to set up my generous allow list again giving my applications some wiggle rooms, uh, some wiggle room that's safe. Another one we'll commonly see is customers might have workload destinations that are outside of their one environment and maybe it's another AWSVPC but it's theirs and so it probably isn't worth spending a lot of time initially blocking access to your own resources just because they happen to exist in an on-prem environment or another VPC or another cloud environment. So go ahead and be a little bit more generous with allowing access to your own resources and same idea with trusted partners. There's some partners you work with that you might trust a lot. There's other partners that maybe you don't trust as much, but the ones that you do trust a lot, go ahead and initially be very generous with how you allow that traffic so you can monitor it so you can log it and you can scope it down later. And so some features that we have launched recently within Network firewall that help with this list is the automated domain list feature. This is an ability to go into the firewall and turn it on into a traffic analysis mode where we just without even setting logging up on the firewall, which we encourage you to do, by the way, but let's say you're just initially deploying the firewall, you haven't really decided how you're gonna do your logging, where you're gonna send it to. This feature you could turn on on day one to say I want to turn my firewall into logging, uh, a learning mode and it will generate a report of all the domains being accessed across HTTP and HTPS for you and that report looks like this. This is for no additional charge on network firewall. It'll generate these reports spanning a 30 day period so you can see what's happening across this firewall in terms of the domains that are being accessed. Very valuable because now I don't have to know how to interpret my logs. I don't have to have additional tooling in place to gather all this information. We just bubble it up automatically in the console for you. So let's take a look at this report. We can see the domain of course are listed, but then we have some other context, uh, and information here to help us make decisions on what to do with these domains. So access attempts I can sort by all of these columns. I can see that this first domain is being accessed a lot of times, and if I move on to the next column, I can see the unique sources that are accessing that domain. Why would we have that here? Well, because we want to bubble up insights, not just give you raw data for you to try to, you know, make sense of, right? So this is helpful because now I can sort by this and say hey there's a large number of my systems accessing this domain therefore it's probably more likely to be safe. I can add it to my allow list I can of course do further investigation on this domain, but I know for sure it is commonly accessed across my workloads, so that's an important signal to pay attention to as I think about updating my list. And then of course first access and last access time frame. I can also sort this so that I can show the domains that are accessed by the fewest number of clients that can be very interesting if I had a domain that's accessed by one client but the access attempts are through the roof, maybe that's something to pay attention to. Maybe that's a misconfiguration, maybe it's a workload that might be compromised and so I wanna bubble these insights up very quickly and make them actionable. You can also use this information to have custom automation so if you wanted to have, for example, a lambda that says whenever you see that a domain is being accessed by literally all of my client systems and it's continually attempting to be accessed, maybe I have that, uh, send an email to my team to say, hey, this domain popped up on the list it's being accessed by everybody you wanna add it to your allow list right? so you can see how this can be used as a foundation. To make managing this generous allowance much, much easier for you over time. And then you'll see the domains are listed as strict uh allow list fully qualified, right? So I, we would still recommend that within this you take the opportunity to see if there are places that you wanna use Regex to allow this. So this is again going to be different for every customer. We're happy to help through some ideas around it, but remember that you don't have to just allow list strict FQDNs. You can run RegX against these. maybe I take a portion of the beginning and combine that with a portion of the middle and then also compare that to the top level domain. You can have firewall rules that are uh that specific and that powerful. So at a high level as we think through how to go through the egress security journey, we want to be reminded of the time, the energy, the cost invested, uh, versus the risk reduction. So there's always a point where each customer is gonna be a little bit different, have a different appetite for where they want to be on the spectrum. We're happy to help you at any place here at any point here, but we do recommend that you start on the left here with the manage rules. The managed rules are very easy to implement. They get that risk reduction down and then move on to custom rules. This is rules like blocking certain high risk top level domains. We can give you a template of these rules, by the way, and then getting very quickly hopefully quickly to that generous allow list where you're taking advantage of the default deny structure of the firewall policy but doing it in a safe way that doesn't impede your applications and then over on the far right it does take quite a bit more time uh to get to a strict. Uh, allow list, but it does reduce risk as well. So you know, depending on where you are and how much you can invest in this, we're happy to help you along the way and we will continue to add features and capabilities to the network firewall to make this journey easier for you. Awesome thanks Jessie. So some other key launches uh we you know we walked through the egress strategy and the the launches that are relevant to help you simplify that journey, but some other launches we wanna make sure you're aware of as you're kind of rethinking potentially your network architecture and how you lay it out, uh, so now we've just launched a support for multiple VPC end points. This is especially. Relevant for folks that want to deploy a network, uh, network firewall across a distributed architecture where previously you had to deploy a network firewall instance across all your VPCs and see, you know, that exponential rise in cost we're now supporting uh this idea of a shared compute across a a network firewall instance where you can put in uh secondary. Network firewall end points across the necessary VPCs and see a reduced cost savings on that endpoint hourly charge so we, we welcome you to take a look at that. And lastly this does go hand in hand with this idea of troubleshooting and gaining additional visibility. We've just launched a native network firewall dashboard on the console itself itself this gives you additional visibility into metrics and insights into traffics to help you look at what rules uh that we talked about might need tweaking, might need scoping down, gives you, uh, insights into top talkers, block domains or rule hit counts, etc. So some key takeaways we've walked through some of the best practices, as mentioned, some things that we want you to make sure you're taking away one. Look and remember that there's two paths out so when you're analyzing your egress strategy on AWS, you wanna make sure you implement both on that DNS, the DNS firewall, but also look at a next gen firewall like uh AWS network firewall. Learn from your traffic, use the capabilities that we've launched and we continue to launch to get that insight and scope down detect misconfigurations, learn from your traffic, leverage that automated domain list feature that we talked about that native dashboard to help you build towards that general allow list. And leverage the latest, the managed rules, active threat defense manage rules that and some of our partner managed, um, uh, other managed rules that we have and some other capabilities that we've what like that that we've launched like the geographic IP filtering and others. So thanks so much thanks so much for your time and coming out and spending. Uh, this great session with us, let us know what you thought on our survey and here's some of our contact information if you ever wanna reach out with some of, you know, questions we're here, we'll stick around and have a great rest of your conference.
