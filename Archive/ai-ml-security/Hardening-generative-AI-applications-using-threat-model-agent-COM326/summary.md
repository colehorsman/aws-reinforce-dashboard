# AWS re:Inforce 2025 - Hardening generative AI applications using threat model agent (COM326)

**Video Link:** [Watch on YouTube](https://www.youtube.com/watch?v=nqllUYDzihQ)

## Video Information
- **Author:** AWS Events
- **Duration:** 16.0 minutes
- **Word Count:** 2,117 words
- **Publish Date:** 20250619

## Summary
In this AWS re:Inforce 2025 session, Shaoyi Li, a lead cloud engineer at PE Technology and AWS hero, presents an innovative AI-driven solution called "Threat Designer" for automated threat modeling. The presentation focuses on addressing common challenges in threat modeling through a multi-agent system that can analyze system architecture diagrams to identify potential security threats.

The session addresses several key business challenges, including the new risks introduced by AI systems (such as prompt injection and model poisoning), the time-consuming nature of manual threat modeling, and the tendency for security considerations to be deferred until late in the development cycle. The solution integrates both traditional STRIDE framework and new AI-specific threat frameworks like OWASP Top 10 for LLM.

The presented solution, Threat Designer, is a serverless architecture deployed on AWS that automates threat modeling through a five-node workflow system. The tool provides automated threat identification, AWS-based mitigation solutions, and red teaming capabilities through a chatbot interface. The system transforms threat modeling from a static to a dynamic process, enabling real-time updates as systems evolve and promoting a "security by design" mindset within organizations.

## Key Points
- Threat modeling early in SDLC can reduce security costs by up to 150 times
- The solution addresses both traditional security threats and new AI-specific risks
- Automated process requires only a system architecture diagram as input
- Transforms threat modeling from static to dynamic process
- Integrates with Jira for team collaboration and tracking
- Provides AWS-specific mitigation recommendations
- Includes chatbot capability for interactive threat analysis
- Supports red teaming exercises with multiple AI models
- Enables continuous security assessment as systems evolve
- Promotes "security by design" organizational culture

## Technical Details
- Built using React framework and hosted on AWS Amplify
- Uses Amazon Cognito for authentication and authorization
- Implements API Gateway with proxy integration
- Leverages Lambda functions for backend processing
- Uses DynamoDB for storing execution states and metadata
- Integrates Claude 3.7 model via Amazon Bedrock
- Implements pre-signed URLs from Amazon S3 for secure file uploads
- Features a 5-node workflow: image processing, assets, flow, threat, and continuation nodes
- Supports both standard and replay modes for processing
- Includes GitHub Action integration for automated triggers from IAC code pushes
- Provides integration with Jira for team collaboration
- Uses multiple AI models (Claude, Amazon Titan, and Anthropic) for red teaming

## Full Transcript

Uh, hi, everyone. Uh, thanks for joining my session today. And, uh, my name is Shaoyi Li. I'm currently a lead cloud engineer at PE Technology, and I'm also AWs hero. And today I want to introduce agentic AI multi-agent system to help you do the threat modeling from just a single diagram, uh, system architecture diagram. And uh let's see how does it work. I think the Uh, this is a comprehensive agenda for my session. I will firstly introduce why we need to do the re modeling and what's the common challenges in the re modeling and how to address it. Next, we will come to the key content of this session. That's a tool, airport tool to do the threat modeling, and I will introduce how does it work and what's the architecture for this solution. And in the end, we will go through a a practical tool, practical demo to know how to use this tool. And uh first, let's explain why we need the threat modeling. The threat modeling is to identify the strides in the early of the SDLC and we can prevent it from becoming the true problem. And skipping the threat modeling can cause very bad impact to the system, such as the uh data breach, the uh system outages, and some brand image. Next, the shift left matters. If we can detect and fix those threats in the early of the SDLC, we can reduce the secret cost by up to 150 taps. And the strength modeling is also very critical requirement in the popular complex requirements. For example, the PCIDSS 12.3.1 require us to the risk assessment and street modeling per year. And re modeling is also a best practice highlighted in the AWS architected framework to design a virus square system. The ID is SA 01-BPO7. And if we can use the re modeling to shift the security to the left in the SDLC we can create a security by design mind site in our organization. That sounds very great, but when we do the modeling in our real life is very challenging. The main challenges I hear from the community developers and organizations are following. The first, the AI brings the new risk to our real life, to our security work. Uh, such as the injection, uh, prompt injection and the model poisoning. We need a framework to identify and mitigate those new AI risks. And the strength modeling is also a manual and time consuming process. I still remember when we do the threat modeling, I say, uh, I sit with our CIO and the member across different team and spend a lot of time to complete a great threat model. And the 3 model also easy to be static and still when the system changes, the previous re model become outdated. And last one because the developers always has very tight uh schedule delivery schedule. So they always defer the security and do the threat modeling in the late of the SDLC. Next, I will introduce how to address those challenges. First, besides the traditional thread modeling framework, such as stride, which includes the spoofing, tampering, and information disclosure, we can use the new AI threads framework or top 10 for LIM. And we can use AI to light the stream modeling to become an automated and streamlined process. And stream modeling also needs to be a continuous and dynamic process. When the system evolves, we need to get the latest thread model in real time. And if we can use AI to like the re modeling process, easy to adopt. The organization will embrace the security by design one side. And the tool to address those uh threat modeling challenges is re designer. Thread designer is an AI driven agent designed to automate and streamline the threat modeling process for security system design. It has the future features. Because we integrate a framework, so we can use that to support AI stress identification. And we can use a tool to automate and streamline the threat modeling process from only a single system architecture diagram. And this to also transform the previous static modeling process to a dynamic one. When the system changes, we can get the latest threat model in real time. And because the tool can shift the security to the left, it also mitigate the threats, but we only have a uh design proposal, we can identify and mitigate those rights. And I will next, uh, I will explain how does it work. It's very typical multi-agent system design architecture, and you can use that for other use case. I will explain the process from the left to the right. The input of the uh workflow is uh the required field is only a system architecture diagram, and you can also add a contextual background, such as the system description and the exception to the input to improve the threat modeling accuracy. And this workflow is built with the long graph framework and contains file nodes. The first one is image processing node. In image processing node, the node will analyze the image, the diagram you uploaded and extract the key information. Using the AI vision capability. And when we come to the assets note, this note let you know what do you have in your system. Then we come to the flow node. In flow node, the agent can help you get the data flows in your system and help you get the chest boundaries. And based all above results, the red node can let you know what you could do wrong in your system based on the OAS and red framework. The last node in the workflow is the continuing node, is a conditional node. If uh the agent will determine if you already create a very great re model. If so, the workflow will come to the end. If not, the continuum mode will forward you to uh back to the stride node and regenerate the re modeling. The output of this workflow are 3. The first one is some basic information for system, such as asset data flow, trust boundaries, and second one is the detailed re list based on the red and OAS framework. It also can give you the AW based mitigation solutions and the red teaming solutions. This, this workflow has two modes. The first one is the standard mode. We need to go through all file nodes to get the re models. And the second one is the replay mode. When you change your system, you don't need to go through all the nodes, and the agent can resume the previous results and uh skip the preceding nodes in the workflow to get the final uh model uh threat model. We also can set the iterations and the reasoning token for this process to improve the accuracy. Uh, this is the overview architecture for this solution is a serverized one and fully deployed on AWS. OK. And in a few next slides, I will delve deep into different parts of the architecture and tell you how to build a practical solution. We use the React framework to build the UI and host the UI on Amplify, and we use the Amazon Cognito for authentication and authorization. All the API calls go through the API gateway and are sent to the back end through the proxy integration. And this solution has two methods to trigger. The first one, you can create threat model on the UI. Then the second one is when you push the IAC code onto the GitHub report, the GitHub action will trigger the certain modeling process. We use a lambda function to build the back end. The first function, uh, manage the current operation for the re model, such as least re model and uh added the re model. And the second lambda function defines the multi-AI workflow logic. The 3rd 1 has the uh chatbot to help you chat with the re models. For the database, we use the dynamo DB tables. The first one starts the agent execution state. So, uh, all the nodes in the workflow can share the same memory and the same state. And it also helps you do the replay, uh, the thread modeling replay. And the second table stores the metadata of the stride models, such as the ID name, and status. So you can get an overview of all the stri models in your system. And the last one through the chat chat history with the re models. For the A model, we use the cloud 3.7, so neat on the Amazon Bedrock through a converse API. The uh the unified API can simplify the JI application development, and you can use that to easily upgrade the model to the cloud for all need. And we use the pre-designed URL from Amazon S3 to securely upload the diagram to the X-ray bucket. And this also offload the image upload, uh, upload from the back end to the front end to reduce the workload on the back end. We also integrate the demo with the Jira so the team in your organization can uh stay on the same page and check the threat modeling very easily. Uh, next, let's go through the demo and see how we use the tool. To create a threat models, we just need to fill several fields. Uh, for example, the name, and you need to upload the system diagram, and you can upload the IC code file if you want to light the tool to have a thresh check. And you can toggle the wasp framework if the application is a JI application. And you also can set the iterations and uh uh tokens for reasoning to improve the accuracy of the results. And those are the required fields and you just need to click start and start the re modeling. The shred modeling is processed by file node in the workflow. And the results is like that. For example, we have a stra uh we have uh a problem injection attack, which is mapped to the OA framework, LMO one. More importantly, you can get a very detailed AWS based mitigation solution. You can see the second line in the mitigation. It suggests us to set up the Amazon Brock guardrail to do the input security validation. And then you also can get many other detailed basic information in this page. Besides the above results, we also can use the chatbot to interact with our re models. We can use the chatbot with the pre-defined sample prompts to generate the remediation plan with the complete and secure IC code file. You just need to copy the IC code file and set up your secure AWS environment. For those people who want to do the red teaming validation, you also can use the chatbot to do the red teaming exercise with multiple models provided by the Amazon Bedrock, such as the cloud, Amazon Nova, and DeepSync. Uh And in the end, let's reveal the key takeaways of this section. The tool is uh automated, streamlined and scalable multi-AI system. And we transform the re modeling from a static process to a dynamic. When the system evolves, we can get the latest re model by just click the start button. Because we also add the Ova framework to this demo, so it is aligned with the novel AI specific strides. Because the the tool also shifted the script to the left. So we can create the secret by design man site among our organization and identify the strides and mitigate them in the early stage of SDLC. The chatbot uh capability of this tool provide a conversational mitigation and red teaming solution for us. In the future, we will keep improving this demo and utilize the AI agent to simulate the red teaming exercise and do the self-heating for our system. Uh, this is the project on GitHub. You can scan the QR code to get the project. Uh, please note the version on the GitHub is slightly different from the version I'm present today, because I made some modification based on my organization's requirements. I will uh leave on this slide for several seconds. And in the end, uh, thanks for joining this session, and I hope you can enjoy this session. Uh, I also hope you can open up your mobile app to leave the feedbacks for this session. I really appreciate it. And that's it. I will uh hold dear and if you have any questions, you can reach out to me. Thank you.
