# AWS re:Inforce 2025 - Build multi-account security controls using Amazon Q CLI chat (GRC321)

**Video Link:** [Watch on YouTube](https://www.youtube.com/watch?v=Bul7nKyrNAI)

## Video Information
- **Author:** AWS Events
- **Duration:** 18.1 minutes
- **Word Count:** 3,036 words
- **Publish Date:** 20250618

## Summary
This re:Inforce 2025 session demonstrates how to build multi-account security controls using Amazon Q CLI chat functionality. The presentation covers the integration of Amazon Q's conversational AI capabilities with AWS CLI to streamline security management across multiple AWS accounts. The speaker shows practical examples of using natural language commands to implement security controls, monitor compliance, and automate security tasks across organizational boundaries. Key focus areas include leveraging Amazon Q's understanding of AWS services to translate business security requirements into actionable CLI commands, reducing the complexity of multi-account security management, and improving operational efficiency for security teams.

## Key Points
- Amazon Q CLI chat enables natural language interaction for complex multi-account security operations
- Integration reduces the learning curve for security teams managing AWS environments
- Conversational interface translates business requirements into specific AWS CLI commands
- Multi-account security controls can be implemented more efficiently through guided assistance
- Amazon Q provides contextual awareness of AWS security best practices and service interactions
- Automation capabilities help maintain consistent security posture across account boundaries
- Real-time guidance helps prevent misconfigurations during security control deployment
- The tool supports both interactive troubleshooting and proactive security management

## Technical Details
**Amazon Q CLI Integration:**
- Natural language processing for AWS security commands
- Context-aware command generation based on multi-account architecture
- Integration with existing AWS CLI workflows and authentication mechanisms

**Multi-Account Security Architecture:**
- Cross-account role assumptions for centralized security management
- Organization-wide policy enforcement through programmatic controls
- Automated compliance checking across account hierarchies

**Security Control Implementation:**
- Automated deployment of security groups, NACLs, and IAM policies
- Real-time monitoring and alerting configuration
- Integration with AWS Security Hub and AWS Config for compliance tracking

**Recommended Practices:**
- Implement least-privilege access patterns when using Amazon Q CLI
- Establish proper logging and auditing for all automated security actions
- Use Amazon Q's suggestions as starting points while validating against security requirements
- Maintain version control for generated scripts and configurations
- Regular review of automated security controls to ensure continued effectiveness

## Full Transcript

Alright, alright, hey everyone, my name is Karin Eikala. I'm a solutions architect at Amazon Web Services. I'm based out of New York City and I support small business customers, uh, in my solutions architect role. Today I'll be talking about how you can build multi-count security controls using Amazon QChat CLI, which is our coding AI AI coding assistant. And the unofficial title for this, uh, talk is Security Meets vibe Coding because I'll show you a solution at the end of this, and I haven't wrote a single line of code, uh, to build the whole solution. So, uh, I, I think that fits the, uh, title. As far as the agenda, we'll just do a quick introduction to what, what we're building. Most of this time, uh, I think the, the butter is gonna be in the demo, uh, then we're gonna do key takeaways and next steps. So security standardization across AW's accounts is challenging but it's critical, right? Some of your organizations require this, uh, you know, various different compliances if you're in the healthcare like HIPAA, uh, having that security standardization is important. It helps your, uh, helps make your job easier and your life easier. Uh, manual creation of security controls is time consuming and it's, uh, error prone. Uh, security teams should be automating as much as they can through infrastructure as code. We shouldn't be in the console creating, uh, roles and writing stuff in the console, right? It's just, uh, too error prone, uh, for security standardization. Security teams need efficient, uh, ways to implement and validate controls, right? Uh, and again it goes back to not having to build everything in the console, having the infrastructures code ready, uh, to deploy. Uh, lastly, compliance requirements have, uh, you know, consistent, you need consistent implementation and, uh, we also need to collect the evidence in a way where we can support, uh, the compliance status for a, a particular framework that your organization needs, uh, NIS, HIPAA, any of the SOC frameworks, right? So, um, that's the introduction of like what we're trying to solve for the customer problem we're trying to solve for. Uh, introducing a service, Amazon Q developer, um, any of you guys use this service or know about this service? See a few hands. Alright, awesome. All right, cool, um. And it's again it's uh AI coding assistant it's designed to help across the software dominant life cycle through your planning, testing, uh, doping, right? Most developers don't spend their time creating code they spend time planning, researching, uh, testing, and they're not building that new code and this is essentially designed to accelerate the whole process, not just the build phase, um. Again, it has uh agentic features to build, um, it's, uh, again it's very, it's trained on the AWS documentation so if you're working within AW's environment it has all the, uh, best practices and I'll, I'll touch a few um things about MCPs later, um. And it again with all AW services it's designed with security and uh um like security it has built in vulnerability scanning and uh remediation. So when you run the uh agent in the IDE or the CLI you can actually run uh tests on the code base to see uh if there's any uh loopholes within the code you wrote. Available where you work, right? We don't want to force AI coding assistance on anyone. We want it to make your life easier. We don't want to add extra work for you to use the AI coding assistant, and this goes to the point of it's available where you work. So if you were a developer that works in the, uh, CLI or the terminal, uh, it's available in the terminal. If you work in IDs, it's available in the IDs we support, uh, hundreds of them, the most popular ones as well. It's available in the documentation, the console application. And uh we have uh we're building continuous integrations into various other uh platforms as well. So, uh, moving on, uh, now we introduce what Q developer is, um, as far as the demo we're going to solve this particular use case where, uh, I, I don't know if you guys, uh, build a lot on the in in the AWS console, but, uh, whenever I'm trying to like build a solution either for like a customer, uh, just demo something out, I go ahead and like give myself, uh, a privileged access right to build a solution. I'm like, alright, once I get it working I'll go back and fix it and be secure, but a lot of times we get busy and. You don't go back and fix those permissions and now we have um IM role with privileged access and now you have a compliance issue. So, uh, what we're trying to solve for here is, uh, using services like Config to assess, audit, and evaluate, uh, your IAM roles, make sure there's no overly excessive, uh, permission or roles that are provisioned, right? We'll use Systems Manager where we can build a remediation document in case uh we do have a uh non-compliant IM resource we can actually go ahead and, uh. Uh, take action and remediate the, uh, noncompliant resource, uh, Security hub, it's our cloud, uh, security posture management system, so we'll have a single pane of glass, uh, to see all the non-compliant resources and security controls. It supports, uh, some of the frameworks that I've mentioned before like the NS framework and, uh, uh, other frameworks that I'll, uh, uh, I'll show you when I get to the demo and lastly. Uh, SNS integration, right? We need to notify our IT admins if there is a non-compliant, uh, resource, so, uh, we'll have integration with SNS to send out those emails anytime uh resource is noncompliant. So I think that's enough for the presentation. I think uh the demo is really the sweet spot of this talk, so let me switch over. So I mean we're we're in the AWS console like uh uh you know, standard things you see um. So let me show you what the um The, the cloud in uh the infrastructure. Uh, the Yahoo file that was created using uh QChat CLI. OK. Alright, so we're in our working directory and to initialize uh the Q developer in the uh the CLI, all you do is type in Qchat. Yeah Takes a bit of time. Alright, cool, um, while that loads, uh, I'll show you the prompt I'm gonna be using to build the solution today. Um, it's a pretty long prompt, right, with any, uh, LLMs these days you have to be pretty specific in what you want the solution to be. It's almost like, uh, you're telling your student or telling a student, um, and being very, very specific in what what you want the solution to be like, so it's a, it's a 42 line prompt, right? And I'm asking you to create me a cloud formation template um using AWS custom config rule to evaluate overly excessive IAM rules. So I'll go ahead and copy this for now. It looks like Amazon Q has loaded up. It's using the cloud force on it model right now. Uh, I can go ahead and, uh, you know, enter the prompt. It's gonna start going through this, uh, automated reasoning and, uh, agentic work flow, uh, to start building the, uh, solution for me. Uh, it does take a few minutes, especially because, you know, I'm what I'm asking for is a pretty tall task. So while that runs, I'll show you like a version I worked on earlier this morning, uh, that was, uh, deployed. So this was the YAML file that I created for me, right? Over, uh, over 750 lines of code that was generated from a prompt, right? And it has resources like, uh, uh, config config code, I mean, uh, lambda code for our custom config rule we'll have resources like um IAM rolls here. And then if I scroll down, we'll have more resources for uh additional lambda functions. It'll have the remediation document for SSM. And then uh you'll see some uh some more um SNS resource that was created in the YAML file for me as well and again all this was one prompt I did not write a single one of these codes it was from just a prompt. And uh again this might you you might be wondering like hey like what about security what about um like you know risks of having a prompt uh generate this all this for me with with QSCLI you can actually have it, um, run security scans after it builds a solution for you so it's like you can ask it, hey, like now you built the solution, uh, can you run a CFL like cloud formation link on it or like sec other security tools on it to make sure that this is a secure solution. So it's really, it really is end to end in terms of the software dominant life cycle. Um, so let me go on the console. I already deployed it earlier this morning. Um, GRC 321. Uh, you can see it created completely or it was successful. You'll see outputs, the confit rules, the, um, evaluation lambda, the notification topic, and remediation lambda. Um, so if I actually go into the actual config rule, this is the config rule we created. Um, and you can see I have a few IM roles that are non-compliant. Uh, so if I go to the IM service. And look at the particular roles. So I created a few tests once right uh for this talk, so if I go to GRC. 321 uh I believe this was one that showed up as you can see it's a administrator access permission it has uh wild card uh actions on actions and resources so you know, clearly this is a, uh, overly excessive, uh, permissions this provision. So if I go back to config screen. Uh, click on Test troll for GRC 321. And again, just um um, you know, preempt this, uh, as part of the solution, it built me a systems manager remediation document which can actually go ahead and remediate this, uh, permissions. So click on remediate. And Saying action cued. So in the back end config is calling APIs to assistant manager to run the remediation document. Uh, it looks like action, uh, is taken successfully. If I go here and I refresh. You'll see the administrator access policy is gone. It adds, uh, you know, default, uh, remediated policy that just has like basic, uh, get list and, uh, describe, uh, permissions. So that's a quick way to just kind of, um, get the, get the, uh, um, noncompliant resources um back into compliance and then as far as the code I can show you guys um. If I go here, there's the evaluation and the remediation lambda function uh if you go into the remediation function and again all this code was part of the cloud formation that that was used to provision these lambda functions, um, again you, you'll see, uh, the helper functions, the um the uh security hub integration right here. Uh, you'll see SNS integration here, uh, actual evaluation logic here. Um, we don't need to go into the code, but, uh, essentially this is a code that's, uh, powering the, uh, identification of the, um, noncompliant resources. Uh, I did mention there's a security hub integration and security hub security hub is our cloud posture management system, uh, single pane of glass we can aggregate findings from multiple accounts in regions for our security people to have one, you know, service that they can go to to get a posture of their environment. Uh, IAM excessive permissions detection. This is part of the custom integration that we've built. Uh, if you go here, you'll see, hey, this particular role is, uh, noncompliant. Uh, it failed the compliance check and you'll see the account ID and the IAM role and the actual resource. So you have the integration there and if I go to my email, I mentioned there's a SNS integration, right? Uh, this is the email I got about two minutes ago. Um, And it shows you um the particular role, the account ID and uh you know it it'll it'll send you that notification to your IT admin to let them know. Um, so that, that kind of that that's the end to end solution we have here and that was again like the craziest part is is all built using one prompt that I showed you, uh, 40 lines of English, right? And it built this whole secure solution for us to automate and it gives us a cloud formation and at that point you can deploy it across all your accounts using stack sets, all your regions, right, um, really speeds up the whole, uh, security aspect of things. Uh, and a few other cool things, um, I'll, I'll talk a little bit about MTP servers. I don't have much time to, um, give you like a full understanding of everything that's involved in it, but, uh, model context protocol, uh, built by Anthropic, right, uh, essentially a, um. And a way for. You're essentially giving additional tools and um to your LLMs right LLM clients in this case it's QChat CLI. So for example, AWS published a list of our core MCP servers, right? We have the diagram MCP server. We have the cost analysis MCP server, and there's a whole list and it's growing almost each week. Uh, essentially these are additional tools LLMs can leverage to give you more accurate, more grounded, uh, responses, and for this, uh, solution, not only did I ask, um, it to build me the solution, I asked it to build me the architecture diagram for the solution it built. And this uses the um AWS diagram MTP server to build me the architecture and you know it looks it looks pretty accurate to me. Uh, so essentially scanning the cloud formation again, um, you know, getting the semantic, uh, meaning behind the, uh, code and then translating that into AWS architectures. Uh, I also use another MTB server, right? Uh, the cost analysis MTB server. And uh what this does is it actually uses um. The actual AW's pricing APIs to give you a current price of an architecture and again this is going through the cloud formation to see the solutions building and the resources that are being used. Uh, of course it made some assumptions on the usage, um, might not be fully accurate here and again, but, but I have the option to make changes in the, uh, in the chats like, hey, my usage is actually is is different. I use a lot more and then I'll update the uh the page for you. So I asked it to create me HTML page, uh, with the pricing for the architecture. Uh, it, it gives you a breakdown by service. It gives you the, uh. The breakdown by the service and then if you go down you have a summary table. Uh, and then it actually gives you, um. Cost optimization recommendations, right, uh, it's like, hey, if you notice this costs are going up, these are a few actions you can take to reduce the cost, uh, and it lists out lists out its assumptions it made, right, um, and you know that that's another way that you can kind of fact check it, uh, you'll have exclusions, uh, in terms of what was calculating the, uh, cost and finally a conclusion. So that wraps up the uh demo part of it and um I thought it was pretty cool that I was able to do all that using just a prompt right? I didn't build any of that. I didn't build architecture. I didn't build pricing, uh, calculator. I didn't build anything. I just wrote 40 lines of English. Um, so switching over. So key takeaways, right, uh, we're using genitive AI to simplify and reduce time to secure environments. Uh, we're no longer spending days and weeks that probably would have taken me at least, you know, 12 weeks if I was only spending on that solution to build it, right? Now I built that sitting in my bed for like 10 minutes, right? Uh, focus on strategy or implementation, right? This shifts the priorities of our security teams, security teams to have more conversations on the strategy aspect and spending reducing the time to actual implementation. Leverage AW's config uh for continuous monitoring. We looked at the service of how it identifies and assesses, uh, noncompliant resources. Uh, we, we looked at how AW Systems Manager can be used to remediate resources, uh, using, uh, remediation documents in integrated with AWS config. Uh, and then use security hub for that single pane of glass to have, uh, uh, access to your cloud cloud posture. As far as uh next steps, these are, uh, some QR codes I recommend scanning and just, you know, um, spending some time on, especially if you wanna learn more about MCP servers, I feel like everyone should, um, you know, be at least comfortable with what MCP servers are. I feel like it's gonna have a huge impact in the next few months of, uh, how companies are gonna be interacting with LLMs and generative AI. So definitely take a look and then uh we have a key, um, more governors risk and compliance sessions that are going on at reinforce reinforced so you can scan the last QR code uh to find a little bit more about that stuff uh but other than that that's essentially the talk. I'll be standing over there if you guys wanna talk about something for the next 15-20 minutes, um, but yeah, thanks guys appreciate it.
