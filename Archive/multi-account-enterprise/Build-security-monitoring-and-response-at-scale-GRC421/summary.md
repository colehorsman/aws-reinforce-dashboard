# AWS re:Inforce 2025 - Build security monitoring and response at scale (GRC421)

**Video Link:** [Watch on YouTube](https://www.youtube.com/watch?v=j-yYTGBCDrs)

## Video Information
- **Author:** AWS Events
- **Duration:** 23.0 minutes
- **Word Count:** 3,803 words
- **Publish Date:** 20250619

## Summary
This AWS re:Inforce 2025 session, presented by Santosh, focuses on AWS CloudTrail and its capabilities for security monitoring and response at scale. The presentation covers CloudTrail's fundamental role as an audit service that captures API actions across AWS services, with particular emphasis on recent feature launches and enhancements.

The session addresses key technical concepts including CloudTrail's three main offerings: event history (free), trails product, and CloudTrail Lake (managed offering). It highlights new capabilities such as network activity events for VPC endpoint monitoring and event enrichment features that allow adding resource tags and IAM condition keys to CloudTrail events, making analysis more context-aware.

The presentation demonstrates practical solutions through two main demos: one focusing on network activity events for monitoring unauthorized VPC endpoint access, and another showcasing event enrichment capabilities for investigating unusual S3 bucket activity. These features aim to help security teams better manage and analyze large volumes of security-relevant data, correlate events, and respond to security incidents effectively.

## Key Points
- CloudTrail serves as a foundational security audit service for AWS activities
- Three main CloudTrail products: event history, trails product, and CloudTrail Lake
- New network activity events feature provides visibility into VPC endpoint traffic
- Event enrichment allows adding resource tags and IAM condition keys for context
- CloudTrail Lake offers built-in querying and analytical capabilities
- All CloudTrail activity is stored immutably for security
- Enhanced filtering capabilities help focus on relevant security events
- Increased event size limit beyond previous 256KB cap
- New dashboard features for better visualization and trend analysis
- Natural language query support for easier SQL query creation

## Technical Details
- CloudTrail Lake offers 1-year and 7-year retention options
- Support for KMS encryption with customer or AWS-managed keys
- Federation capability with AWS Athena for querying
- Three event types: management events, data events, and network activity events
- Network activity events currently available for 15 AWS services including S3 and EC2
- VPC endpoint monitoring captures both allowed and denied actions
- Event enrichment supports resource tags and global condition keys
- Dashboard configuration for regular activity trend monitoring
- Resource-based policies for sharing CloudTrail events across organizations
- Natural language to SQL query conversion feature

## Full Transcript

Hopefully you guys can hear me. I'm Santosh. Uh, thanks for attending the session. Uh, this is the build security monitoring and response at scale, uh, focused on Cloud Trail, which is a foundational service that I'll be talking about. I'm hoping that all of you guys are, most of you guys are familiar with what the service is. So this is the short agenda for the talk today. Uh, I'll give you a quick overview of what Cloud trail is, um, go over some of the cool new features that we've launched in the recent past, and we have two demos for you, um, one around a new event category that we launched recently around network activity events, and another demo around, uh, enriched events that we, uh, recently launched as well. And, uh, hopefully you guys will enjoy the demo and see how these new capabilities are, are improving your. your overall posture for the security perspective. All right, like everything at AWS, um, Cloudtrail takes security very seriously and it's one of the foundational things that we actually enable and also sort of ensure, uh, just from a, from a service perspective that everything that we do helps our customers, uh, have the best security, uh, sort of capabilities and posture for your respective services. A quick overview of what cloudtrail, hopefully most of you are familiar with what the service does, but foundationally what Cloudtrail does is it acts as um a sort of audit for all the activity that Um, any account in AWS is performing, so it captures all the different API actions that are performed on the different AWS services. It also allows you to sort of store that and analyze that for a variety of different AWS, uh, or security use cases from threat detection also to uh sort of reactive investigations to understand any vulnerabilities in your. In your in your uh perimeter, um, and you can also go back and sort of analyze recent and historical activity for all the different use cases that I just sort of mentioned right now. Um, this is the sort of foundational uh overview of of Cloud Trail in in general, but the, the, the three sort of products that we offer for for Cloudtrail one is uh a free product called event history that You know, captures, uh, what we call control plane activity, and you can look up that that history for free, um, in the console as well as through the AWS API. Um, the second product is, uh, called a trails product where you can then capture all the activity, both control plane as well as dataplane activity, and then send it to an S3 bucket of your choice that you can then either use air services such as Athena query or you can use third party, uh, capabilities as well of your choice. And the third, uh, service that we're gonna be spending a lot more time talking about today is Cloud Trail Lake. It's our end to end managed offering that allows you not only to, uh, you know, store AWS uh cloud trail activity, but also allows you to sort of retain that for a period of time and it also has built in querying and analytical. Uh, features and also to help you visualize, um, you know, sort of the findings in a manner that, you know, help you sort of create dashboards, uh, so that you can look at the activity on a regular basis and, and see how, uh, your sort of overall AWS activity has been trending over a period of time. I Um, one of the things that we also ensure is that any, uh, any cloud trail activity that is stored in, you know, any of the different services that we offer are immutable, so that provides security and gives you confidence that all the audit trails that we're capturing are, you know, immutable in nature and cannot be tampered with, uh, by, by many, any bad actors. All right, this is, um, all the different things that we've been launching in the recent past, and, uh, the two that I've highlighted are the ones that I'll be talking about in terms of like of a demo later on today, uh, the ways in which we organize these launches are around, you know, what are the different capabilities we've launched for for cultural events and what are the things that we're doing from a visualization and analytical capabilities perspective and finally what are the GI related features that we had actually launched, um. In terms of the actual event type itself, um, sometimes cloud trail events can be quite voluminous in nature, and it's, it's important for customers to only focus on, on certain cloud events that are most relevant to them. That's why we continue to, you know, sort of, uh, uh, add more filtering capabilities that you can then, like I mentioned, used to focus on just relevant activity for your use case. Uh, the second feature that we launched is our network activity events, which is a new event category. That provides you net new visibility into AWS uh activity that is traversing through VPC end points. So if you're a big VPC, uh, customer, this could be a relevant, uh, launch for you, and we'll we'll talk through it and then also do a quick demo for you as well. The third is we um launched enrichment of events where we want to make the the analysis of cloudural events more context aware and the way we do that is by adding um or allowing you to append resource tags as well as IM condition keys in the event itself, the clotural event itself, so. Uh, you can imagine, sort of, you know, filtering certain collateral events by application context or different contexts such as finance or, you know, cost center based context for you to sort of, you know, look at specific uh collateral events that are that are most relevant to your, your use case. Um, we also, uh, increase the event size for cloud rail events so that, you know, you have, uh, you can, you can analyze your cloud trail events without having to worry about some of the activity being truncated, which could happen, uh, for other, uh, sort of, uh, you know, cloud trails events in the past which is capped at a 256 KB limit. Um, and finally we also launched additional visibility into specific S3 batch delete operations. In the past you'd only get. Um, the actual batch lead API action itself but not the subsequent individual actions that are, uh, that are executed as part of the batch operations. So now with this launch you have very detailed, very granular specific, um, activity or visibility into the activity for for such batch lead operations. Uh, in the, the visualization and analytical vertical, we launched new dashboards the last 6 months that allows you to sort of, you know, uh, configure all of these activities in the form of like, you know, visualizations, and then go back to it and see on a regular basis how the activities is actually trended to identify any, uh, events of interest from a, from a security perspective. Uh, we also made it easy for you to share these different cloud trail events stored in, in a cloud trail lake more easily across your organization. Um, so if you, if you have the need to sort of only share a subset of events with a certain team, uh, it makes it easier through resource-based policies for you to do that, uh, in a more seamless manner. And we continue to add GI related features in terms of how do you. You know, use, uh, natural query language creation to write queries, SQL queries, especially if, if you're not familiar or highly technical in nature, as well as once you get the results, execute the query and execute the, uh, and get the results, it had to summarize the, the actual, you know, uh, hundreds and thousands of potentially, uh, you know, voluminous results that you actually get from a query perspective. In Um, just to set up the, the demos that I'll, I'll be doing, um, these are the standard security challenges that you know most of you actually face. You have a lot of data to actually pass through to identify, um, any interesting events of note from a security perspective. Then you need to sort of try and identify whether there are, you know, events that are correlated with each other or completely independent because that could help you understand the severity of the threat. Um, and then, then, you know, you also need the ability to sort of understand how do you actually respond, uh, and remediate these, uh, these, you know, incidents of, of interest. So these are the standard typical, uh, standard typical challenges that that security teams usually face. So going on to the first um demo that I'll be doing right now on network activity events, just to set up what uh what it is, and, you know, why it's so critical. Um, if you're a PPC, uh, customer, you probably know this, but you know, a lot of our customers operate or wanna operate in a, in a private cloud for security reasons, and you know it allows them to sort of, you know, um, also then ensure that there is a strong security perimeter around their services and so for such customers they use EPC endpoints as a way to sort of communicate outside of that virtual private cloud and and access sort of services that they need to. Um, and so to provide customers additional visibility into what's happening through these VPC endpoints, we launched a new category of events called network activity events that, uh, will provide to the VPC endpoint owner all the detailed event, uh, that's traversing through the VPC endpoint, such as, you know, if actions are certain actions are denied because of the VPC endpoint policy that's captured. And also any actions that are allowed through the VPC endpoint, they're also captured as well, uh, so this was not possible previously, but, uh, because of this launch, you know, you now have net new visibility into what's happening through these uh VPC end points. Um, right now the service is available for, you know, uh, 15 odd AW services including big ones. Um, such as S3 and EC2, but it would be adding more services and eventually getting to all 350, uh, AW services from a coverage perspective. Uh, the typical problem statement that you know we have here is that you, you wanna identify whether there is an unauthorized access that's, um, that's trying to, uh, you know, execute any AWS activity going through VPC end point and you know how do you actually identify who that is and you know what's what's the, uh, what's the user identity related to it and which account is actually trying to execute the VPC endpoint or you know actions to the VPC endpoint. So that's the first demo that we'll actually be covering um in a little bit, but before I, I go to the actual demo, I want to talk about the second, uh, use case that we'll be talking about around event enrichment, um, and like I was mentioning earlier, this is the ability for, for you to append resource tags, uh, and select global condition keys to the clotural events and what this allows you to do is just, you know, makes it easy for you to categorize search and analyze all your activity in a certain context. Um, as, as a consequence, you'll be able to, you know, create applications specific activity reports, um, uh, using the resource tags in the cloud events itself. And, and the problem statement for this demo is if you're a, you know, security team, for example, that needs to investigate unusual activity for files within an S3 bucket, um, maybe those S3 buckets are tagged with a certain, uh, set of tags such, such as, you know, is this data classification sensitive or is this a, a production environment or is the staging environment, etc. um, and allows you to sort of just focus on those sensitive buckets and identify what, what actions are being performed by whom. Um, you know, under certain circumstances. So those are the, the two things that we'll actually, uh, do from a demo perspective. So I'm going to switch over to the, to my demo and then we'll walk through the experience there. All right, so this is how the cloudtrail Lake console actually looks like today. Um, I'll, I'll spend a minute just explaining how you typically set up the first event data stored, which is essentially what we call tables within, uh, within the cloud trail lake experience. Um, so typically what you do is click on. He went to the store and I, you know, just name. The Vera store, um. And you have two choices of, uh, you know, pricing for cloud trail lake based on how, how long you want to store these data, these sort of events, uh, upfront. So you either have a one year, uh, retention option which is ideal for those customers who have a certain, you know, amount of data which is like not exceeding 25 terabytes as such. But if you have a lot more data and you want to retain it for much longer, then a 7 year retention pricing is probably a better option for you. So once, once you choose the pricing option, um, you also have the option of, you know, selecting whether you want KMS encryption using your own key or a WS managed key. Um, I'll just leave that as default. You also have the option of, you know, enabling federation that that allows you to use uh AWS Athena to query the actual data that resides in your cloud trail lake, um, and then just going forward. This is where you select the specific cloud trail event type that you want to capture. So you have a choice of, of selecting management events, uh, which, you know, is controlled in activity. Data events, which is data plan activity, and the new event category that I just described right now, which is uh network activity events itself. Um, and, you know, for the, for the purposes of this demo, I'll just leave it as measurement events. And then, Going forward. This is where you can specify specific uh resource tags that you want to enrich your collateral events with. So in this case, for example, uh, I'm more interested in data classification as a tag, as well as the environment. I click on next. And finally create the actual EDS itself. So I'm not gonna go through the full uh creation process because I, I have a few EDSs already ready. So for the first demo, which is around network activity events. I'll choose One of the event data stores. And if you look at how I've configured the network activity events to be selected here, I've specified that, you know, uh, just collect cultural events, uh, that are going through this specific VPC endpoint that have these IDs, um, and, and that allows me to sort of just focus on specific VPC end points. So I've set up this, uh, EDS right now to collect VPC endpoint, uh, network activity events that are troublesome this VPC endpoint. And uh let's go back and see what I can do with this from a creating perspective to see, you know, what, uh, analysis I can actually do. Um, so we have It's really cool querying feature, uh, or in a sort of uh screen here that allows you to either, you know, um, type in a natural language expression and I'll convert that into an actual SQL query for you, um, and, and then sort of you know help you analyze the data. So I have a few sample queries already saved here. And I'll, I'll talk about what is the specific query I'm gonna run first, which is, you know, just give me a list of all the um access denied actions that took place and, and sort of traversing this VPC endpoint. So I'm gonna click on that. And let's see what it shows. So I definitely want to promote. So, what, as you can see, it, it listed a bunch of uh API actions, um, that were, you know, that occurred through the CPC endpoint, and I can just extend uh the different, I can look at the specific action, you know, details about the action and why it was denied, and what was uh what was the specific. Account that was trying to access it, which is this column and the specific user identity that that that was involved in the action as well. Um, you can then use the action, uh, the account ID and the user identity to to sort of identify whether these were authorized actions, authorized, uh, actors or not. And then based on that, you can, you can, you can either uh contact the, the account owner to find out why they were trying to access this when, you know, they were not supposed to. Um, this is the first query in terms of just listing out all the different actions that happened through this. Uh VPC endpoint. I have another query that actually helps you visualize this, this better. And what this does is just give me the count of all the uh VPC all the access to action that happened through this VPC. So let's run this as well. And this, this tells me that there were 30, um, you know, incidents of this particular account trying to uh access the resource using a put object event name and there were 33 such actions that the same account ID tried to execute using the delete object uh action as well. And I'll show you how to actually create a uh a visualization out of this. I'll choose the bar chart here, um, use a label for event. Uh, name. And value as. I want right. I don't want that. And then you can actually see that these are the specific. Um, counts for delete object as well as the put object here. Um, I can add this to a dashboard as well so that I can, I don't need to, uh, keep sort of creating this, this paragraph, uh, or bar chart all the time and pin it to my actual dashboard. So this is how, you know, my save dashboards actually actually look like and um you can look at the specific. Barshell that I created in the in the past as well. So this is an example of how you can use loudtrailla to visualize the, the, the activity that's happening through BPC endpoints, um, and give it sort of makes it very much, very intuitive and powerful for you to actually take actions on this as well. Um, going back to this, the second demo, um, around event enrichment, I'll, I'll show you a couple of queries that they'll tell you the power of actually using those tags that you've, you included in the, the clotural events itself. So going back to the query. I'll change the EDS. And go back to my saved queries. And the first query is just to list all the specific uh cultural events, um, that, that, that related to the put object and uh delete object actions for S3. And, and that's all I sort of care about because these are the actions that I think are most most sort of vulnerable or important. And let's see what this actually shows us when we run that. Not very real So this gives me the full event context for all the actions that uh that occurred to delete object and put object. And if I just extend the event context, you'll also be able to see the specific um resource tags. Related. To this event. And the specific ones that I'm most interested in are the data classification and the environment tags. So, uh, As you can see, the, the tag for the classification for this particular event is sensitive and the environment is is production. Uh, so this doing this allows me to sort of understand whether these actions are potentially sort of severe because the declassification is sensitive and the environment is, is, you know, production versus staging or testing or or whatever else it is. Um, I will also show you how to maybe visualize this as well. Um, using And for example, if I just want to filter by the specific um data classification type as sensitive, I have a query here that I can run and it just shows me and narrows down this, all the actions that are only relevant. To a specific set of um objects that are sensitive in nature. So as you can see the data classification here is sensitive and that only allows me to focus my uh analysis on a small subset of, of actions. Um, and, and just finally, one last query that I want to actually show you is how do you visualize this data, uh, by just identifying this, the actions for the, you know, sensitive S3 buckets. And you do that by running a query and I actually have the, the uh dashboard saved, so I'll I'll quickly go over the dashboard here. And just refresh the dashboards here. otherwise it will be. I think I chose the wrong dashboard. Um, We no longer. So Right, awesome. So I, I think, uh, I'm probably not able to find that, that one dashboard, but you get the general gist, you can then use these dashboards to look at specific views of uh of activity and then you know visualize them as bar charts as well as, um, pie charts as well. So this is, um, just a few ways in which you can use cloud trail lake to look at specific events of interest and then use a visualization to create sort of charts or of them. Um, hopefully, you know, you find this session useful and if you have any specific questions that I can answer around cloud trail leak or cloud in general, please free to sort of, uh, you know, catch me on the side and happy to answer those questions. Cool. Thank you.
