# AWS re:Inforce 2025 - Building stronger cloud defense with real-world insights (SEC207)

**Video Link:** [Watch on YouTube](https://www.youtube.com/watch?v=ipeF8KsIXag)

## Video Information
- **Author:** AWS Events
- **Duration:** 53.5 minutes
- **Word Count:** 8,383 words
- **Publish Date:** 20250619
- **Video ID:** ipeF8KsIXag

## Summary
This session presented real-world incident response insights from Palo Alto Networks' Unit 42 team in partnership with AWS Security. The session featured case studies of cloud-native attacks including crypto mining operations, large-scale extortion campaigns, and phishing infrastructure deployment by threat actors like JavaGhost. The speakers emphasized the speed and scale of modern cloud attacks and provided practical recommendations for detection, containment, and recovery strategies.

## Key Points
- **AWS-Unit 42 Partnership**: Security Incident Response Service Ready partnership with 15-minute SLA response times
- **Crypto Mining Case**: Attack started with exposed access keys, deleted CloudTrail logging, created large EC2 instances
- **Large-Scale Extortion**: Cyclical attack compromising 110,000+ domains, collecting 90,000+ environment variable files
- **JavaGhost Campaign**: 5+ year threat actor using federation tokens for console access and creating cross-account trust policies
- **Attack Infrastructure**: Threat actors use Lambda functions, Infrastructure-as-Code, and automated scripts for rapid deployment
- **Speed and Scale**: Modern attacks happen with "alarming speed, precision, and scale" - faster than traditional on-premises incidents
- **Common TTPs**: IAM persistence through new users/roles, trust policies for external access, access key manipulation
- **Detection Challenges**: Attacks in unused regions, publicly accessible environment files, overly permissive credentials

## Technical Details
- **Containment Strategies**: Balance rapid response with business continuity, use tags for criticality identification
- **Logging Requirements**: CloudTrail in all regions, VPC Flow Logs, S3 server access logging for legal compliance
- **Forensic Preservation**: EC2 memory capture and snapshot features for evidence collection without business disruption
- **Service Control Policies**: Lock down unused services to prevent threat actor infrastructure deployment
- **Federation Token Analysis**: Get-federation-token and get-signin-token API calls for console access without login profiles
- **Infrastructure as Code**: Consistent deployment patterns help detect anomalous resource creation in CloudTrail
- **Access Key Management**: Short-lived credentials, credential rotation, avoiding environment variable exposure
- **Network Segmentation**: Minimize internet exposure, patch internet-facing systems immediately

## Full Transcript

So yes, uh, to talk a little bit today. I'm Dan O'Dea with Unit 42 from Palo Alto Networks, and we're gonna talk today a little bit about, uh, a bunch of cool stuff, but especially our partnership with, uh, AWS security team and I'm gonna be introducing allowing my colleagues to introduce themselves, both Margaret Kelly and Jen Paz from AWS. They'll be introducing themselves as they come on stage shortly. Um, my background is, uh, military, federal law enforcement, and then been in consulting for a little over a decade now doing incident response type work, so specifically doing digital forensics and incident response. That's what Margaret and I specialize in and then you could think of us like cyber firefighters and arson investigators in some ways, and we're gonna talk today about some case stories and some things that we've seen in AWS and about the partnership that we have with AWS and how we can help customers, uh, with those things. So this is just a high level overview of a little bit about what we're going to be discussing um I'll briefly introduce us and uh we'll talk about the partnership and we're gonna share some more stories and just kind of walk through some things we see, talk about some of the most common tactics and trends that we're seeing in incidents in AWS right now. Uh, and then we'll talk through some recommendations related to that, and we're gonna have a panel discussion with both Pow Alto Networks and AWS, um, kind of answering questions related to that. So initially, Uh, Palo Alto Networks, if you're not familiar with us, um, you know, we really wanna be a cybersecurity partner of choice, and we have well over 85,000 customers or global organization, a lot of different things, and Unit 42 specifically focuses on kind of threat intelligence and services, and that gets baked into Palo Alto Network's products. So we have both proactive services as well as managed services like our managed detection and response, managed threat hunting, etc. And then our incident response services, which is where Margaret and I both specialize and again that's all with an underlying foundation of threat intelligence and that threat intelligence piece like I said, gets baked into the product. So even if you're not an explicit unit 42 customer for using. Any Powal to networks product whether our next generation firewalls, whether our endpoint solutions, cloud solutions, then you're gonna be benefiting from that threat intelligence, uh, because we make sure that we protect all our customers rapidly as soon as we get information that is 24/7 we are enriching our products. Um, Unit 42 publishes a lot of information so you can learn more about the kinds of things that we're doing and talking about. The big one that's most recent is our global incident response report. We'll have a QR code later if you're interested in that, um, but there's a picture of that on the top left of this slide. We've also got our extortion ransomware report. Cloud specific reports minor attack reports where we talk about the most common techniques and actually what that looks like in attacks we're also we have a blog where we talk about stuff all the time, including lots of things involving AWS and incident response matters with AWS uh and we we're on Twitter, we're on LinkedIn, we have a bulletin. We also have a GitHub repository called. Unit 42 timely threat intelligence where we just get stuff out IOCs and stuff like that really rapidly all the time and so um all that stuff public publicly available and we share that widely. I'm gonna invite my colleague Margaret to come up and talk a little bit more about our collaboration with AWS and uh start talking about some more stories. Hi everyone. Uh, my name is Margaret Kelly. I'm a principal consultant at Palo Alto Networks, Unit 42, and today I want to talk a little bit about the Unit 42 and AWBS Security collaboration. We have some big news. Palo Alto Networks was named Global Technology Partner of the Year, and some of the highlights of this is helping organizations go from their code to cloud to their security operations center. And as you can see on the screen, there are numerous distinctions with this award. The one that we are going to be talking about today is the Security incident Responder Service Ready partnership. Let's take a look at what this partnership looks like between AWS and Unit 42. Now no one knows AWS better than AWS, and when you open a security incident with them, their SLA to respond is unparalleled. When you open a new case, an AWS incident responder will reach out to you within 15 minutes to start working with you to determine what your concern is and what might be going on in the environment. Now when you combine that with the broad reach of Unit 42, who has the ability to incorporate other data sources outside of AWS, including on-prem and SAS applications into the investigation while also performing as the incident command for those large investigations, you truly have a winning team to help you in your time of need. So before we get into these case studies I wanted to talk a little bit more about how this partnership plays out in those case studies. So throughout an investigation both teams will help you understand what's going on within the environment. So not only will we contain the threat, we will eradicate the threat actor as quickly as possible. And this is my favorite part. Along the way, we also provide recommendations and best practices so that you can better secure your environment. So now let's get into these case studies. So similarly to an investigation with the case study, we'll talk about what the threat actor did and then after each of them we will discuss the different recommendations and best practices associated with that case study. So for this first case, it originated from a notification around high billing uh with EC2 instances in a single AWS account. Upon further review, the organization identified multiple large EC2 instances, and as you can guess, they're being used for crypto mining. Breaking down the attack path here, it started with an exposed access key. Access keys get exposed in numerous different ways, and they can get exposed in internal and external code repositories as well as being exposed on publicly accessible hosts as well as sometimes they have to be in environment variable files, but then those environment variable files are made publicly accessible so then those credentials are also leaked. After the threat actor gained initial access to the AWS account, they proceeded to do something that's actually pretty abnormal. They deleted the cloud trail logging that this client had enabled. This is abnormal because as we all know, cloudshare logging is enabled by default for 90 days and is accessible via the API so there really wasn't a lot of point of doing it because their attack was pretty noisy already, so they disabled this logging and immediately a guard duty alert went off to also notify the organization of this abnormal activity. Following this, they created a new identity and access management user and used that to then create these ginormous EC2 instances that they used for crypto mining. So looking at some of the remediation and best practices, there are so many that apply to all of these scenarios. So we're gonna talk about the first one, which is using IAM roles and making sure you follow credential management best practices. Access keys are long term credentials, and they don't expire, which is why it's absolutely recommended that you use roles instead because those are temporary credentials. Now some applications you have to use long term access keys and you can't get around that, but you wanna make sure you are following credential management best practices and not leaving them publicly accessible to anyone on the Internet. For this next case study, it's a little more complex, and it has a couple of different components to it. It was a large scale extortion operation that impacted multiple environments because of leaked environment variable files. Within these leaked environment variable files, there were thousands of credentials that were exposed. Here we have a play by play of the attack. It starts with this publicly accessible environment variable file. Now some applications still require environment variable files, but they don't require them to be publicly accessible. So in this case, this environment variable file was publicly accessible and unfortunately it did contain an access key in secret. The threat actor obtained this access key in secret and pivoted right into the AWBS environment. They performed a couple of different discovery calls specifically against identity and access management, as well as S3. Following this, they created a new IAM user and then this is where it gets interesting. They created multiple lambda functions in every single enabled region. Now, these lambda functions weren't unique. They were the same lambda function in every single region. Now to wrap up the attack they had two pieces left. First one, they use those lambda functions and they, uh, excuse me, they scanned a list of domains on the internet and surprise, surprise, they looked for publicly accessible environment variable files. Following this, they exfiltrated the data from this organization's S3 buckets and proceeded to extort the victim. Taking a step back, this is what this threat actor infrastructure looks like at a higher level, and it's actually a very cyclical attack. So starting at number one for AWBS account A, you have a threat actor compromising the access key in secret, logging into that account, and proceeding to create these lambda functions. The lambda functions then scanned the internet for publicly accessible environment variable files, but then, instead of putting them in AWS account A, they actually put them in AWS account B. AWBS account B contained a publicly accessible and rideable S3 bucket. So that's where the threat actor uploaded the environment variable files. They then proceeded to look at these environment variable files and pull out the credentials that they wanted to use. In this case, it was an access key in secret. Then we have AWS account C where they did the same thing and so this whole attack happens over and over again. Looking at this case in the context of other cloud cases that we handle, you can really see that these attacks are happening with alarming speed, precision, and scale. These threat actors have cloud expertise and they're constantly taking advantage of poorly configured environments and they're knowledgeable about cloud services they were able to spin up these lambda functions exceptionally fast and when you're looking at the speed of the attacks, yes, these. Lambda functions they had them already created they had the script set up but in other attacks threat actors are using infrastructure as code as well as scripts to create their attack infrastructure and so the speed of the attacks continued to happen faster and faster. And finally, when you look at the scale of impact, it's pretty massive. In this case alone, it impacted over 110,000 unique domains. And looking at what was gathered, there's over 90,000 unique environment variable files gathered, and of those 90,000, 7000 of them were associated. With cloud services as well as SAS applications. Looking at all of these credentials gathered, we group them into a couple of different categories. Application, database, and email are the highest. That's not overly surprising. But what is interesting is the high number of cloud credentials, and this really shows the shift that we are continuing to see of organizations moving to the cloud and using SAS applications and so this also shows the shift in the threat actor landscape to have the threat actors continue to attack cloud environments. So for some remediation and best practices, again, there's a couple that we could go through, uh, but I'm gonna focus on using infrastructure as code, as organizations. Using infrastructure as code really helps to have consistent and very secure deployments and then when you're trying to monitor for abnormal activity. Your in-house deployments will be very consistent. It'll follow a very similar pattern within the cloud trail logs. So if you have a threat actor or a rogue employee trying to spin up resources, it's very detectable in the cloud trail logs if they don't follow the same infrastructure as code pattern. Now, for a final case study, this one revolves around the threat actor group Java Ghost, and they have impacted multiple industries. Taking a look at their history, they have been active for over 5 years. And they historically focused on website defacement, but now they've shifted to sending out phishing emails. Let's take a deeper look at one of these attacks. So this is what the Javao attack path looks like. Again, it starts with an exposed access key and then after that they gain initial access to the areas account. I call out specifically though that they gain CLI access to this database account because access keys give CLI access. But this threat actor was not content with CLI access. They wanted console access and to be able to visually see what's in this account. And so instead of attaching a login profile to this user that they had already compromised, they tried to be nefarious and hide and so they performed two different API calls. They first performed Git Federation token, and with the results of that API call they proceeded to perform the call get sign in token, which returned an authenticated URL from the base access key credentials. Now, with that URL, the threat actor now has console access to this ADS account without attaching a login profile. After this, the characterctor group does something else that's interesting. In the other two cases, we saw them create new IAM users. They didn't do that in this case. They create new IAM roles and attach a trust policy. So what this trust policy does is it grants a different external AWS account access to this specific role. So now the threat actor has another way into this AWS account for persistence. One of the reasons they choose to create a role versus create a user is people tend to forget that you can just come in through a role and so when you're trying to clean up actor creative resources sometimes this gets missed. So finally the threat actor creates their phishing infrastructure. So if an organization is already using the simple email service and work mail, they'll use the preexisting infrastructure and send out their phishing emails. If an organization isn't using SES or work mail, they will set up the infrastructure themselves, then send out all of these phishing emails. Javagos performs a couple of additional operations that I find really interesting. The first one here is creating a new security group. The name of the security group is not surprising. It's Java Ghost, and the description is the group's slogan, We are there but not visible. Now with the security group there's no rules attached so there's no rules allowing inbound or outbound traffic and the security groups aren't attached to any EC2 instances. They purely create the security group to note that they have been in this account. The other interesting thing that they do is create new IAM users and access keys. These new users have unique names and also names that they try to blend into other existing users and with these access keys yes they're being attached to these new users that they're creating, but they're also getting attached to preexisting users in the hopes that again during the remediation process they will get missed. And finally they do attempt to enable disabled regions and they do this in the hopes that they can spin up their fishing infrastructure within an unmonitored region. So taking a look at the remediation and best practices, the one I want to focus on today is using service control policies to prevent unused services. Within your AWS environment, you will have a ton of accounts. You might even have hundreds of them, but each account will probably have unique workloads that don't need every single service available. And so by using SEPs to lock down those unused services, you can better manage what can or cannot be done in that specific AWS account and so then JavaO can't come in and spin up those phishing emails in one of your accounts. Now we're gonna pivot and look at some of the high-level tactics and trends that we see within our cloud attacks. So here are the top 5 that we like to talk about, but today we're gonna focus on exfiltration and impact. Exfiltration is still a common issue that we see time and time again, and this is all because of overly permissive credentials. And so what threat actors do is they get into an environment and they're able to do whatever they need to do and then on top of it they exfiltrate data and they're exfiltrating data from S3, EC2, and RDS and not only are they actually. Trading the data and they again have their permissions to delete the data so they delete the objects, delete the buckets, they delete the EC2 instances and the snapshots, and they delete the RDS databases and the database snapshots. Looking at some of the notable TTPs, I wanted to look at how IAM is used for persistence. You saw in a couple of the case studies threat actors really like to use it in a variety of different ways. They like to create new IAM users. Some threat actors take the time to see what existing IM users are in there and try to match the names of those. Other ones don't care, they create blatant obvious IM users that stand out. And then threat actors are absolutely using trust policies to grant external access to the account through those roles and finally they're also deleting and creating access keys. So with the creation of access keys I talked about earlier, that they get attached to new and existing users. On top of that, if a user already exists and it has an access key attached, but the access key has not been used for days, months and sometimes years, what the threat actor will do is delete the access key because clearly it's not being used, so no one's gonna know when it goes away and they create a new one to again enable persistence. Now I'm gonna pass it back to Dan to talk about some more recommendations. All right. So Margaret's covered a lot of awesome trends, a lot of the things and shared actual stories about how we see these, and these stories were chosen, um, as representative examples because we see a lot of variations on a theme. Uh, when looking at these sorts of things, so some of these things, you know, we say they're the basics, but we all forget to do them, and, um, so it's good to get reminders. The first is to really log everything everywhere and that means even in regions that you're not using because threat actors love to spin up stuff in regions that you're not using because they're thinking you won't look right so making sure that you've got logging there, uh, making sure you've got VPC flow logs enabled S3 server access logging a lot of times we don't see that and especially. If you have any kind of regulated information in S3 objects, so I'm talking about personally identifiable information, protected health information, things like that, um, anything that could trigger a data breach and legal obligations for you if it were to be exposed. This is really important and the reason why is a lot of times S3 server access logging is not enabled by default and then you're left looking at just at bandwidth outbound from a specific bucket and you don't know what specific objects might have been exfiltrated. And if you don't know that, then a lot of times from a legal perspective, you might have to make the assumption that the entire bucket's been exfiltrated because even though you may know it's not the full volume of data with however you figured that out. Um, you don't know which explicit objects had been exfiltrated and so now you've got to make an assumption, and that can result in a much larger data breach notification than if you had access logging. Now you know exactly which objects have been interacted with and you can narrow down the scope of notifications from a legal perspective, um, further making sure you have a strong identity foundation, uh, Margaret's already talked about that quite a bit, so it won't go much over but of course using short lived credentials where you can. You know, applying the principle of least privilege, etc. knowing who's responsible and accountable for resources, especially large environments we get it you have, you know, lots and lots of accounts, things like that it's very easy sometimes where we find something is happening in an environment like can we isolate this? Can we shut this down. And a lot of organizations aren't even sure they're like, oh, we don't know what team is using this particular EC2 instance. We're not really quite sure how this lambda function these lambda functions, uh, fit into our larger operations, whatever. And then there's uncertainty about what you can do when you're trying to contain and remediate an uh an incident. And that lag of time can enable the threat actor to further its impact, uh, so you know this is what tags are for in AWS and and you know other documentation that your organization uses, um, whether you've got, you know, existing, um, tooling for asset inventory and, uh, configuration management and such, and then of course limiting external exposure if it doesn't need to be on the internet, don't, don't put it on the internet. Um, I know Margaret already talked about implementing SEP, so leave that there, but obviously that great tool for permission management. Um, minimizing exposure rate, you want to basically manage vulnerabilities, make sure you know where those vulnerabilities are. This applies whether you're on prem or in the cloud, of course, but making sure you're aware of those things and that shared responsibility model and, and taking responsibility for the items that fall on you to manage those things, especially if it's Internet facing should be patching those things immediately as fast as you can, uh, because obviously they're gonna be targeted in automated fashions sometimes within. Uh, minutes or hours of, uh, those vulnerabilities having proof of concepts made available online, be sure to monitor for abnormal stuff, right? This is where guard duty and power to networks products can help out a lot is monitoring for those abnormal things, um, and then of course using cloud guardrails, so permission boundaries to avoid common missteps. This can go a long way, uh, in preventing, uh, things from getting far too out of hand even if there's an initial intrusion. Uh, furthermore, Unit 42 can assist your organization with this. We do cloud security assessments, and that's something where we can come in and look at your environment, identify potential issues before it gets to the point where those are used against you, uh, by a threat actor, which hopefully never happens, of course, but help find the blind spots and things like that. So taking the guesswork out and getting some data to back up your posture. So that's been kind of the high level part of our talk. We're actually gonna be transitioning into a panel discussion shortly. Did want to just share a couple of resources, uh, really quickly though. The first one is the global incident response report, uh, from 2025. We've got a QR code up there. I promise we won't rickroll you with these QR codes, um, but that one is gonna give you lots of insights about IR reports, not just cloud, but also, you know, all sorts of. Things it's a lot of data so we've done like a lot of data science work to try to find the trends and talk about these things a lot of great points for your leadership, especially if you're trying to get funding for different things and say hey look, these are the areas, these are the initial access factors how they're typically getting in. So one highlight for example from that report is um fishing has often been an initial entry. For many organizations last year, um, we actually saw software vulnerabilities take the lead as the number one initial axis vector and phishing has retaken the lead again, uh, for 2025, so kind of an interesting trend to talk about it still matters. Uh, social engineering is still a thing. There's all sorts of ways that people are getting into organizations. Uh, and then the threat factor is a podcast that we have, and Margaret has been, uh, a featured guest on that podcast. Uh, episode 49, I believe, uh, is the dangerous cloud misconfigurations. This QR code is actually broken. Uh, well, I don't know that it's actually broken, but the, the site has changed the URL since we published this, and so you won't get far. That, but if you go to uh Threat Vector podcast, you can find it in a variety of outlets Cyberwire or on Power Upto Network sites episode 49. You can hear more from Margaret talking about the dangers of cloud misconfigurations and don't hesitate if you have any issues to get in touch with both AWS or Unit 42 or both of us, which we're gonna talk about more in a minute, um, but here's a couple ways that you can contact Unit 42 24/7. Uh, 365 we also again have our research at unit 42.owaltonetworks.com. All those articles that we showed earlier and things of that nature, those are some of the places you can do that. So now I'm going to invite both of my colleagues up and I'm gonna, uh, have Jen Paz, uh, give herself an introduction. She's from AWS, one of our colleagues, and we're gonna shift into a panel discussion. And talk through some more things and, and let you learn and hear both perspectives from Unit 42 and AWS. Jen Hello. Hi, my name is Jen Paz. I'm with the customer incident response team here at AWS. I've been with AWS uh for about 6 years now, so it's, it's been a, a great, amazing journey. Uh, I started off actually my career in, uh, audit and compliance. Uh, so just been a very interesting journey to get to where I'm at now. Uh, essentially just want to be more hands on keyboard, uh, and so. Yeah, I'm, I'm now with the customer incident response team and love it. Very cool. Jen, could you tell us a little bit about some of the unique capabilities of AWS security IR and some of the unique capabilities that your team has? Yes, uh, so I don't know if you've heard, uh, we recently, uh, launched the security incident response service, uh, in at reinvent in 2024, uh, so. I would say the features that I want to highlight of the service, well, first of all, we help, uh, uh, customers, uh, detect and response from security incidents, uh, and the features that I want to highlight is the auto triaging, the auto containment, um, and, uh, TTC which I will talk about, uh, in a little bit. Uh, so the auto triage essentially takes away that alert fatigue that, you know, security professionals, you know, feel and, you know, it's a real thing. That's something that we've heard from customers is the alert fatigue. We want our security professionals to focus. On what's really important, right? So we took that feedback and we said, OK, um, we, we will, we will take that on, uh, as part of a feature for this service. So we do the auto triaging and we will only, you know, present to you the incidents that actually really matter that are are true positives and that you should, you know, focus your time on. Uh, so that's the, uh, auto triage portion of it. Uh, then we have the auto containment portion. Uh, the auto containment portion, uh, does have a human in the loop element, so don't worry, we're, we're not just, uh, you know, gonna just press the big red button there, um, and you know, that's, that's only if, you know, for whatever reason you, you, you need to use that feature, it's, it's available. Uh, and lastly, the TTC, uh, I wanna make sure I get this right. Threat technique catalog. TTC, uh, uh, we recently released that, uh, right before reinforce. Um, and essentially it it enriches, uh, post-incident reports, um, that's part of the service, uh, with, uh, the techniques that were used by the threat actor, um, and it's, you know, AWS specific, and yeah, so that's, that's one thing that I definitely wanted to highlight the security incident response service, um, yeah. Very cool. And I have to brag on the TTC for a minute because I just learned about it last night actually. And if you're familiar with the Miter attack framework, it's like that tied to AWS, but more specific because right, you're not going to see any mention of S3 in Miter attack. But when you look at the TTC, it's gonna give you that vocabulary, that incident vocabulary, both talking about. The tactics and the techniques of these threat actors specific to AWS, it's really awesome for both for AWS but also for all of us to be able to have that vocabulary to talk about things in a unified way and it gives you now things that you can use to tune detections and they're all based on actual things seen in cases by AWS if I'm. Absolutely yep. So really cool stuff. So one of the things I wanna ask the panelists is what are some of the most common things when folks are containing and trying to recover from incidents? What are some of the most common mistakes that you see customers make that can prolong the recovery and prolong the time it takes to contain those incidents? I'll take it. OK. Uh, I would say not. Fully following all the bread bread crumbs that are available, um, so. I actually want to give an example that's uh closely tied to something that Margaret mentioned during her presentation. Uh, so let's say, you know, you have a uh compromised access key and you know, you are doing a log analysis and you're like, OK, uh, what did the threat actor do? What unauthorized resources they did they spin up? What specific actions are they doing? Um, you know, you're, you're doing your analysis, right? And you're, uh, going in and saying, OK, well, all of these resources were created by the unauthorized user. Let me go in and, and, you know, clean this up. Uh, and you notice in those API calls you see something get federation token. You see that API call in there and you're like, well, you know, let me focus on the mutative events. Let me clean, let me clean that stuff up and for whatever reason you just overlook the get federation token. Um, so, you know, again, let's say you've, you've cleaned up those resources, you've disabled that compromised access key, um, but you don't do anything about that get federation token. So that federation token provides uh a session for the threat actor. So, OK, fine, they're like, OK, you wanna, you know, disable the access keys. I got another way, you know, to keep doing my nefarious activities, uh, and. I believe that You know, it, it, it could be, uh, you know, the stress of dealing with the security incident or, you know, maybe an education piece there where, you know, overlooking that Federation token. Is, is so key and you know having those AWS experts, having the customer instant response team or you know just having a SE that really understands the ins and outs of, of the implications of these API calls is so, so important. And uh so I guess to tie that all up, uh, to, you know, properly contain that specific scenario would be to, uh, Apply an inline policy, uh, for that specific user that's using that session. Um, there's now, now you don't you actually have to manually put in that specific policy you can actually that's actually in the console where you can revoke the session. Um, but I, I would say that is just following the breadcrumbs and really truly understanding the implications, you know, of, of, of those API calls and, you know, what the impact could be, you know, and yeah. Here I'm gonna pass it over. No, it was perfect. Um, I would say on top of that, you know, making sure again like what Jen said following the API calls these little things like modifying a security group rule, all of a sudden you're a threat actor if you allow SSH inbound from the Internet where initially that was locked down, one little rule change and you're like, oh this is like, you know, one little thing actually now allows inbound access to your AWBS environment. That you want to make sure that you're really focusing on all the little pieces because that one little thing that you missed truly can prolong the incident from, you know, you might have it contained in a day to weeks and weeks and weeks because they keep coming back in. Very helpful. So what are some of the strategies and automation techniques that you see that can be most effective in accelerating detection and containment? I'll start with this one, so making sure that your cloudshare logs are being centralized in one location and that you are also reviewing them and that you have set up alerts and detections based off of those cloud logs in a centralized location that really helps to very quickly identify what might be going on within the environment and when it comes to containment practicing it. So you don't wanna get to an actual incident and you've never practiced containment before and containment takes place at all different levels takes place at the IAM level and it also takes place at the actual resource level. So if an access key is exposed, do you know where the access key is located and how it's being used in your environment? Because if you don't know and it's a business critical operation and you want to contain it. Your business isn't gonna be really pleased when you, you know, lock down that access key and all of a sudden it has a massive negative business impact, um, so I would just say make sure to continue to practice the containment at all the different levels because it's not just host space anymore, truly is identity, um, and there's just so many more components to it. I think yeah. Yeah, I'll add uh to the other side of that, the respond and recover. Uh, so ensuring you have backups for your critical data is super important and not just, you know, setting up that, you know, scheduled job, but actually going in and verifying that those backups are there, that, you know, it's, it's actually uh backing up your data based on the schedule, like really going in and ensuring that that data is backed up. Um, and, uh, you know, just, just having those recovery strategies. OK, X incident happened, now what? Do you have procedures? Do you have, do you know the right people to contact? Um, have you done tabletop exercises to, you know, practice this, this muscle muscle memory? Uh, so, yeah. So how do you balance the need for rapid containment with that risk of disrupting critical workloads or losing forensic evidence when we're dealing with cloud native incidents? Yeah, sure. I'll take that one. So, it all comes down to the business, right? All business requirements, um, and the customer incident response team, you know, we will let you know, OK, these are the implications of doing XYZ. Uh, so, for example, you know, customer is, you know, experiencing a security event and say, again, they have uh uh compromised access keys. So, in that specific case, you know, there, there's options there, right? You can disable those access keys or you can delete those access keys. But let's talk about the implications. Let's talk about the impact that that uh that that has, right? So, Explaining that to the, to, you know, the customer is super important and saying, OK, look, if we do, uh, disable or let's say they want to go in and just delete the access keys. What other workloads are depending on that specific access key? Let's let's talk about that, right? So let's, you know, let's apply other mitigations. For example, we can go in and, uh, let's say the compromised, uh, principal has, you know, start star and has access to everything. Well, maybe let's start there. Let's let's say that, you know, those access keys actually are, you know, that there's workloads that are dependent on those access keys. All right, let's, there's other, there's other mitigations that you can put in place. So just having that, uh, knowledge, that background is, I think super important and Um, again, it, it all goes down to the business, their business requirements, um, you know, is it, uh, part of regulatory compliance requirements that they, you know, need to keep, you know, forensic data, all, all of that, right? So, Working with, working backwards from those needs, uh, is, you know, how we will, you know, help the customer and whatever we can and just really provide them the options, right? Like, OK, yeah, you want to go down this path, OK, these are the implications and yeah, really, really understanding uh all of the, uh, you know, what ifs. And to add on top of that to make your life easier to understand the business impact, use tags. Tags are phenomenal. So with your critical resources, tag them. So tag whatever the business unit is, tag the criticality. If it's critical data, tag that it's critical data. And then when you need to remediate and respond very quickly, you know, hey, this is a super high critical application, we probably shouldn't, you know, start deleting the access key and taking it all down. We need to make them more nuanced approach of fine tuning it. Um, and so that then helps you respond a lot quicker. So having the tags to understand the criticality as well as the contact using your A to BS environment gets so big, sometimes you don't know like who owns this random super critical business application and when it's 2 a.m. and you're trying to hunt someone down, good luck. So use those tags um to kind of do everything that Jen was talking about. And specific to let's talk about EC2 instances just for a second, um, what are things let's say there's an impacted like within the operating system on an EC2 instance we want to preserve forensic evidence from that. What are some of the unique abilities we have in AWS to preserve that information while still being able to rapidly recover that we might have a harder time with if we were on prem? You wanna start with that? Yeah, so there's a couple of things here, um, before containing the EC2 instance you want to obtain the memory and if you haven't done this before, you absolutely want to test this ahead of time. So obviously try to gain the memory as quickly as possible. But then use the snapshot feature. So that is how you can quickly gather this information to then, you know, do whatever you need to do to contain the threat to the whatever the workload is, um, but you know, use the snapshots to kind of, uh, get you what you need there. From AWS's perspective specifically, what are some of the most critical security responsibilities that customers have to own to enable effective IR? Yes, uh, the lovely shared responsibility model is something that, uh, we, we really want to help, you know, educate customers with, right? Um, the customer incident response team helps customers when they're having, um, you know, a specific security incident, and we're actually, uh, you know, helping with, helping them with the security in the cloud, right? Um, so we're, you know, You know, walking through the security incident, the analysis detection, all those, all those pieces, uh, it's really important to understand that the, and also depending on the service, uh, the, uh, configurations, the uh encryption of the data, all of that does fall on the customer, uh, and that's super important to. Uh, no, and also just depending on the service, right? You can have EC2 versus S3. EC2 you need to, you know, set up the security groups, uh, the, uh, permissions, the patching, all of that, right? Uh, with S3, you don't need to worry about, you know, patching S3 or anything like that, but you do have to worry about encrypting your data, uh, and setting a bucket permissions, all of that. So, Understanding that not just the shared responsibility model, but really understanding that uh per service is, is really important and super critical when it comes to dealing with security incidents because that information is, is, is really important and something that um I would say is, is super uh pivotal for, for a security incident. And so when Unit 42 is called in initially on an AWS incident, what are some of the common initial states of preparedness or lack thereof that you observe in organizations? So unfortunately a lot of organizations still do not enable cloud trail logs and store them in a centralized location. So thankfully we can get them from the API or else we'd be really blind, but normally a lot of organizations don't have any logging enabled and so when the conversation comes down to what data was exfiltrated kind of like what we talked about earlier. Unless those logs are enabled, you're not going to know and so you can use some other services like the cost and usage reports to kind of get a feel of what might have gone in or out of the environment, but a lot of times you're blind to very critical pieces of information. Um, so a lot of times login is not enabled, um, a lot of times organizations don't know what's in their EWS account, um, so that also kind of makes it difficult when you're trying to figure out kind of what's normal or abnormal, um, because, you know, they don't know what's in there, uh, so there's just, you know, a lot of training that can be done to, um, to really better secure these environments. And for either of you or both of you, what foundational security measures do you often see being overlooked by customers? Mhm. It's, it's going back to the basics. Um, it's the least privileged principle, right? Um, a lot of times, uh, for example, if you're, uh, testing, you know, this, this new feature or you, you're implementing a, uh, POC, you, you know, we, we see usually customers in sandbox environments, uh, just give it full admin privileges and then when they go to actually, OK, we're gonna use the POC in production. Uh, did you go back and uh And uh uh use the principle of least privileged. Did you ensure that, you know, only the permissions that are actually needed to complete Xy thing is, is only applicable to that specific principle. Uh, so least privileged is, is definitely something. That we're always talking about with customers, uh, and you know, there's, there's ways to really understand what your work, what permissions your workloads need, right? You can, uh, within, uh, within IAM I believe it's like security credentials. There's in the IAM uh console, you, you can see the history of what permissions your, your work or your roles users used. So that is, I think, the most overlooked feature because you can actually you can't, it's no longer legitimate to say, I, I don't know what permissions, you know, the specific workload needs, so I'm just going to give it everything. No, there, there are, there's history, there's data that you can go back to to see and say, actually, uh, this is only the subset of permissions that are applicable, you know, for this specific workload and doing that. Iteratively, right, don't, it's not just a set it and forget it kind of thing, ah, so. Least privileged, that would be, that would be the, the answer for me. So on top of that, the other thing, um, I would say resources don't need to be publicly accessible. That's still something that shocks me every time when we get in an environment. And they're confused why, you know, they locked everything down. They're like, these things should not be accessible anymore and I'm like, well, there's public IPs associated with all of your EC2 instances, and they're like, Oh, I thought it was required. Like I thought my EC2 instances had to have these public IPs and it's like, well, fun fact they don't and that absolutely, you know, should not be the case. Um, so that's also something that we commonly see. um, so you know, similar to principle of least privilege. Principle of don't make your resources public. So we've talked about a number of different visibility gaps today. We've talked about obviously not having cloud trail enabled. We've talked about not having cloud trail in all regions. Um, we've talked a bit about S3 server access logging, um, so in addition to those or if there's anything further you want to expand on those, what are other common visibility gaps that you see that can hamper an investigation? So one thing I'll start out with is VPC flow logs. So again, similar to S3, when you're trying to understand kind of what went in and out of the environment. If you don't have VPC flow logs enabled and if you don't have any sort of third party firewall in play, when it comes to the network level, you don't have a lot of visibility there. So VPC flow logs are one that I definitely add into the mix. Anymore? So finally kind of in conclusion here, what's one key piece of advice that each of you would give to organizations who want to mature their incident response capabilities specific to their AWS workloads and environment. Yeah, so this is one of my favorite questions, um, and I would say it's training. So taking the time to train your incident response team so that they have looked at the cloud trail logs before they've looked at the VPC flow logs and also doing this through purple team exercises. So have some members of your organization. It could be your engineering team that goes and spin up some rogue. Sources kind of do a little, you know, purple team exercise hire AWS or Unit 42 we'll come in and do it for you, um, but that is something that I think is so beneficial for teams not only, you know, training on how to use AWBS and use the logs, but proactively going in there and creating the scenario, uh that would produce the logs that are very similar to what you would get in an investigation. I'm gonna take that from a a more uh tactical perspective. Uh, so, nearly 70% of the incidents that the customer incident response team receives are due to uh compromise credentials. Uh, so my advice would be, if possible, Use, use something outside of long-lived credentials. Use rules, uh, use, uh, federation, uh, for your workforce. Long-lived credentials, uh, we, the customer is in a response team when we, when we're, you know, with, uh, customers, we Don't know where these access keys are stored. We don't know where the customer is storing these access keys. We don't know, we don't have visibility into, you know, these, the GitHub repos that they're, uh, you know, storing these, uh, access keys. So, uh, definitely, uh, if possible, you know, stay, stay away from long-lived credentials and, you know, use roles, federation, um, that would definitely be number one advice there. Well thank you everyone for your time for joining us today in this session. We hope it was productive and uh useful information for your organization. Thank you so much for Jen for joining us and uh we're looking forward to this partnership and we've already been doing it. I shouldn't say looking forward. We've been doing it, but we're looking forward to continuing that partnership to further help you right and get it in 15 minutes and kind of help out with the entire incident whether in AWS or outside of AWS when they pivot. You know, and helping secure your enterprise from code to cloud to sock with Unit 42, Pow Alto Networks, and AWS working side by side to help you out. Thank you so much. Thank you all.
