# AWS re:Inforce 2025 - Multi-stage threat detection using Amazon GuardDuty and MITRE (TDR302)

**Video Link:** [Watch on YouTube](https://www.youtube.com/watch?v=t6NMnPLuizI)

## Video Information
- **Author:** AWS Events
- **Duration:** 59.9 minutes
- **Word Count:** 9,195 words
- **Publish Date:** 20250618
- **Video ID:** t6NMnPLuizI

## Summary
This presentation focuses on multi-stage threat detection using Amazon GuardDuty and MITRE frameworks. The speakers discuss how modern cloud security threats typically progress through multiple stages, from initial reconnaissance to data exfiltration, and how organizations can detect and respond to these threats.
The presentation emphasizes the importance of understanding the complete threat chain in cloud environments, particularly how attackers move from compromising credentials to escalating privileges and ultimately accessing sensitive data. It highlights the integration between AWS security services and MITRE's frameworks (ATT&CK, Defend, and Engage) to provide comprehensive threat detection and response capabilities.

## Key Points
- Multi-stage threats in cloud environments follow a predictable chain: reconnaissance → initial access → credential access → privilege escalation → persistence → data exfiltration
- Layered security controls are essential for effective threat detection and prevention
- MITRE ATT&CK framework is based on real-world observations and provides a common language for security professionals
- Compromised credentials and misconfigured CICD tools are common initial attack vectors
- The ultimate goal of most threats is accessing sensitive data, not necessarily the compute infrastructure

## Technical Details
- Amazon GuardDuty - Extended threat detection features mentioned
- AWS IAM (Identity and Access Management) for permission management
- AWS Lambda functions - potential vector for threat actors to establish persistence
- AWS S3 buckets - common target for data exfiltration
- AWS DynamoDB and RDS databases - mentioned as potential data stores requiring protection
- CICD tools - identified as potential security weak points for credential exposure
- MITRE frameworks:
  - ATT&CK
  - Defend
  - Engage

## Full Transcript

Hi, good morning, everyone. I really appreciate you, uh, making it to the earliest slot in the conference and waking up early and beating the lights outside. So thank you for being with us now. Uh, we're really excited to talk today about multi-stage threat detection with M and Amazon Car duty. I'm Shahar. I help customers detect threats in their cloud environment, and I work at AWS as a product manager for Amazon Car duty. Um, hi everyone, I'm Pritima Singh. I'm a solutions architect, uh, at AWS and previous to being a solutions architect, I was a security specialist essay. Um, I work with Capital Markets customers, uh, Down Under, that's in Australia, so I've come all the way to talk to you about the session today. So good to see you here. And hello my name is Shane Steiger. I'm with Mutter Corporation. I'm a principal cybersecurity engineer. Uh, I work within the cyber resiliency team, but I also, uh, do work for Engage in the cyber deception space as well as for, um, in Attack and others. So to set the foundation, I'll walk you through a multi-stage threat. Um, we will then hear from Shane uh how the MIDA frameworks specifically attack, defend and engage, work towards detection and remediation of such threats, and then we will have Sahar who will come in and talk to us about how you can do the same with automated features from Amazon Guard duty, especially the extended threat detection features. Now let us start with the cloud workload. A typical cloud workload is basically composed of a set of permissions. Now these permissions are set through AWS Identity and Access Management Service or AWSIAM. Then you have the compute engine you could do you could use different types of compute that churn business logic to secure the data or access the data that's sitting in your data stores. Now these are your crown jewels at the end of it, what are you trying to secure is is your data is your customer's information. Now when we look at the threat chain, it all starts with a threat actor. An adversary that is trying to gain access to your information. They don't much care about what compute you run. All they care about is how they can get access to your data. Now they run a scan to start with, to look into ways that they can access the infrastructure that you have deployed in your environment. Now this is the first step in the threat chain. This step is called reconnaissance. This is where the threat chain starts. Now say the threat actor succeeds. You've got access keys stored in your CICD tools or you've got access keys that were committed to your code repositories, and they're able to retrieve those access keys or credentials, and they're able to use those credentials to establish the level of permissions they have. So what can they do in your environment? The threat now moves to the initial access step. So they've been able to establish because these credentials were associated with your CICD tools that deploy infrastructure to environments so they have elevated privileges so they end up creating new credentials with a lot more privileges that these credentials the previous credentials could offer now we're moving this moving the threat to the credential access stage. Now the threat actor can then add permission to create new resources or create new IM rolls and also access your data through those new resources that they have created. Now this leads to a privilege escalation stage. Now from here a series of events will kick off. They're able to with those new permissions that they have set up, the threat actor is now able to establish persistence. They're able to set up compute resources, say an AWS lambda function, give it permissions to access your data stores, your S3 buckets, your Dynamo DB tables, or your RDS databases. And of course through the lambda function they're able to pull that data out in this example I've picked an S3 bucket they're able to pull data from the S3 bucket and finally exfiltrate those files that may contain protected information like personally identifiable information or PII or even healthcare information if you are a healthcare business and this is information of the customers of your business. Now once they have hold of your data, the threat chain is effectively complete. When you do review the events that have followed that have happened in the past, it emphasizes the value of having layered security controls. So not just a singular control to to protect a certain step, but having it in multiple layers and ensures that even if certain layers are passed through, you have the right protections through. Now such tactics, techniques and procedures or TDPs, uh, this is just an example, right? They are a subset of a large number of TDPs that are defined in industry standard frameworks like Mor attack, defend, and engage um these TDPs help us define how you help us set the baseline for threat intelligence that you will use to define you will use to detect threats. Now I'd like to invite Shane on stage to help us understand how MITO frameworks like attack, defend and engage, um help in threat detection and remediation. Thank you. Thank you. So Um, just to give a little context on uh myself, I started out my career in the late 90s, uh, doing ITOT uh security infrastructure and um later moved on to uh for a large food organization and later moved on to doing um some kill chain analysis and kill chain methodology uh then leading up to um 2015 bringing attack framework as it started to. Um, develop within the larger organizations that I was working with and in 2018 I came to, uh, Mitter to actually build a bridge between cyber resiliency and the attack framework so that was somewhat my first charge um and so as a result, let's start talking about the frameworks, the ones I'll be talking about today are attack, defend and engage. So from the attacker's perspective what is attack? So for anyone who might not know much about attack, I'm hoping to give you like a couple minute crash course on attack, but what's really key is attack attack is a knowledge base of adversary behavior. It's an iteration of the things that an adversary can do. Um, uh, might, uh, you know, likely do or has done, but the real key to it, it's based on real world observations, so it's not based on, you know, proof of concepts or, um, you know, theoretical, but it's based on real world observations what folks have seen and reported and the interesting part about the attack framework is it was originally born of an idea of taking a hyper censored lab. And with real people doing real things creating lived in noise real work on a day everyday basis and making that hyper sensored lab hyper censored at the um end point at the network and engaging adversaries and then gathering up the TTPs that they tend to share or seeing what the artifacts are that were laid down. And so as a result, um, that was part of uh how attack was born and then my uh actually my first project at Minor was to help uh a few others run the um lab that made attack and, uh, I, I learned a bunch from that but you know the key part is it's based on real world observations. Other key parts is, hey, it's free and open for anybody to come and and uh engage in. So you know it's out there it's hack.mitter.org. It's part of our public interest mission to have that out there and um you know as part of that, uh, you know, folks from all levels from students to to sock analysts to vendors can go and uh go out to the, uh, attack website and see what what's out there, what things folks, uh, have entered as well as what we found. Uh, it's become a common language, so folks, you know, tend to, uh, now speak in, you know, TIDs and so forth, and I'll talk a little more about that, but tend to speak in, you know, the attack techniques or the attack tactics and as a result that, you know, being a common language helps to bring folks onto the same playing field when they're talking, um, across industries and, uh, uh, across the spaces but. You know, one thing that it's really, you know, it's key to understand as well is it's community driven we don't see everything we have to, you know, rely on folks to report and tell us what things they see and bring that, you know, back within the attack community and then also obviously uh give credits as contributors. So Attack, uh, it usually starts out with this, um, you know, why, why would you wanna go down, uh, you know, creating a framework of well, it's, it's kind of interesting or simple, uh, it's really goes back to, uh, David Bianco's pyramid of pain, and that's where the adversaries have sets of things that they're doing and the attackers have sets of things, uh, that they're do or the, uh, defenders have sets of things that they're doing. And trying to take the artifacts that are out there and see what you know or indicators of compromise things from the adversaries' perspective are, you know, somewhat easy to change like, you know, hash value can change a single bit and that changes the hash value, um, you know, it gets a little. Uh, you know, a little harder but not much harder for changing IP addresses, changing domains, so as you start to summit the pyramid of pain, the adversary's life starts to get harder and more annoying at the host or artifact level and, uh, definitely more challenging. You know, once you force them to swap out their tool sets, they have to, you know, gain the initial access again and maybe get a tool set in, but where attack is kind of the, the, the, the sweet spot is at the top of the pyramid of pain. It's really hard, you know, we're creatures of habit, attackers are creatures of habit changing out TTPs, that's where the real value is. So, um, for those of you, uh, who, who might know, but, uh, I'll I'll walk through this real quickly, um, there's the, uh, the attack framework as a, you know, a matrix, and here we have, uh, across the top are the tactics, so the adversaries technical goals, so their technical goal might be to. You know, get initial access and therefore, uh, you know, go to a point that they can go and potentially, uh, exploit locally and then laterally move so each going across the top from initial access all the way through execution, all the way down to collection and impact. Those are all the technical goals that an adversary might have, but then going down we have the um how those goals are achieved so the techniques that the adversary might uh want to you know use or leverage in order to get uh you know the the goal of initial access in order to get the goal of collection, the goal of lateral movement. And you know some of those are shared across multiple tactics but uh you know some of them sit mainly within a tactic category. But you know, getting going down a little further, uh, just looking at say a particular technique like fishing here, uh, there might, there might be a set of sub techniques that go beneath that like in this case spear fishing attachment or spear fishing link or spear fishing via service so as a result you've got yourself, um, you know, different levels of, um, you know, kind of abstraction down to an actual sub technique level. And then even further yes down to the procedure level well who you know what threat group might have uh performed this particular action so going all the way down to the um the procedure level is is also key and within the framework and defined. But taking a step back, let's just look at the technique of fishing. There's a high level description with each of the techniques as it's entered into the um attack framework and then there's also potentially links to other things like in this case it's got a link to um valid accounts. So you know why would you maybe wanna, you know, send a uh a spear phishing link, uh, it's to get a valid account so those relationships might show up within. Uh, particular technique or sub technique and you'll see that within the framework. But if you dig down just a little deeper either at the technique level or at the sub technique level you'll see that TID or that uh ID so each one of the um uh techniques or sub techniques are uh you know uniquely identified by an ID number and you'll see that as the uh right here 10 or 1566001 is a sub technique to the technique or a tactic. Uh, or technique of 1566 fishing and then initial access is the um tactic level and then you'll see the platforms where it makes, uh, you know, where these techniques or sub techniques are performed on Linux, Windows OS and then you know as I said, community driven so you know there's a contributor here. Each of the techniques may or may not have a mitigation, so there's 44 mitigations within attack. You can go out and you can see per technique or sub technique if there's a mitigation that might apply something that might be useful for you to understand either to mitigate for detection or to mitigate the actual technique itself, and so they're also uniquely labeled as you can see as an MID here, um, you know, M1049 antivirus or 1031. You know, uh, network intrusion prevention. But you also need to understand, right, I need to be able to know how to detect that these techniques have been used and so you, you can go out and look back out to right, where are the data sources where I might need, um, you know, information in order to you know build up that level of this is the technique that was used so as a result there's data sources so application logs, you know. Uh, file and so forth and they're also uniquely labeled and this is where you kind of get the idea that if you don't have a data source you're likely not gonna be able to detect potentially a particular technique so it's key to understand that there's relationships that go between them. So Crash course you might say what are the use cases for attack? There's the obvious use case of, you know, sharing information about detection. How do we get folks to understand what techniques have been used and how do we detect that they've been used? What are the indicators? And so there's the detection use case. There's the threat intelligence use case so gathering this up across multiple threat groups, how can we overlay what maybe multiple threat groups are doing, see what are shared. Um, TTPs and then therefore figure out how to block them from, you know, a particular shared space so you can block more than one threat group. There's the assessment and engineering use case where you know you're looking to assess what your gaps are, so you know just like I talked about data sources might not be present. Uh, so as a result you're gonna wanna know, right, where are my gaps where my telemetry or my censoring is not as good and therefore I need to figure out a way to get a capability, uh, in play and then there's adversary emulation, uh, portion, you know, I talked about, uh, attack being born of a real lab. Well, one of the things that was interesting during my time, um, helping with that lab was. That there were cyber games we were doing live fire, lived in noise, and those folks were um you know, working every day and we were able to emulate and not affect them and their work but still emulate what the adversary was doing and figure out how to create potentially more TTPs from our you know our red team or you know in some cases, you know, adversary engagement really making it happen with real stuff. So that was a crash course on attack. Um, let's talk about change our perspective a little bit to defend. So if you could wander every or wander out on a lot of security conference floors, you see thousands of vendors. They're, um, they might have multiple products doing multiple things from an uh security architect or engineer standpoint. You're trying to figure out all right, how do I distill this down into um a manageable engineering problem that I can then engineer and uh be able to bring in defensive cyber countermeasures that would make sense and that's actually relational to say um something like attack well. Um, because of that significant confusion and, you know, kind of the vendor space, uh, there's no vocabulary really shared amongst those vendors, so we decided to come up with one, and so Peter Kalamarcus and his team have come up with the fend and it's, it's a knowledge base and a formal model. It's really trying to go and iterate through an ontology method which I'll talk about in a second. The same elements of all right if we look at our um if we look at our uh environment our infrastructure, how can we break this down into digital artifacts? And then those digital artifacts, do they have relationships between the attacker and the defender and so as a result there's, you know, uh, uh, from the Defend website there's, you know, over 500 digital artifacts with relationships between attackers and defenders within there. It's, uh, digital artifacts of computers, uh, um, you know, things that you might that both sides might be able to do computers, networks, databases, files, processes. And how does that relate in a a knowledge graph which you see here on the right and how do we put that into practice? Well, I'm gonna do one other thing and show you a bottom line up front and that is, uh, Peter and his team recently put out, um, defend CAD so not only could you, you know, were we breaking it down manually, but now with um CAD you can go and actually. Uh, build your own breakdown of the, uh, defend framework of those relationships so that you have a knowledge graph, um, that you've built on your own and in the background, uh, you, you're able to go right, these are the things that I need, uh, in order to understand. What are the, you know, architectural implications as a cyber defender and then what are the, um, you know, from the attackers' point of view, where do I have the gaps so that I can bring those all together but it's meant for detection engineering, meant for CTI reporting and that adversary emulation red team, uh, blue team pen test type scenarios and as I said, uh, you know, it's out there it's under defend. Uh, but it's, uh, you know, it's free for anyone to go and engage and use. You can import, uh, JSON, uh, you know, files of your particular, you know, uh, from Attack Navigator and so forth, your particular, uh, challenges that you want to come in and you can import and export those features as well as, um, what graphs you save, so that's out there but. Kind of digging in to defend a little bit, so you say alright well what I, I heard you talk about these digital artifacts. How does that really work? Well, you know, for say process injection so you're you're as an attacker, it's born of attack, um, the offensive model being, hey, I've got an exploitation for privilege escalation. My goal is to modify some process code segment and do so by process injection. So there's an offensive relationship which actually is um also something that a defender would want to do you'd want to verify that uh there was no process code uh injection in play so that relationship brings us to a digital artifact ontology. There's an offensive relationship uh that modifies and there's a defensive relationship that verifies so bringing that all together allows for you to, hey. If I get something that may detect this inferred um challenge of modification, then I have now, you know, uh somewhat described a um you know, cyber defensive countermeasure to uh the attacks, the attackers' um, point of view. So that's what you see with Defend and what's really interesting as I said is, you know, there's 500 artifacts currently out there and the control mappings that go between, um, uh, defend and then attack and back to the digital on ontology method. So it kind of brings us to the point of right what does defend become? It, it becomes a unified ontological model for uh customer domains and and definitely across multiple customer domains like, you know, um, you know, cyber architects, cyber engineers being able to talk with the same language, share the same vocabulary, much like we. Had with attack, um, you know, threats, countermeasures and vulnerabilities and weaknesses we can now talk in the same language uh it also allows for use cases like detection engineering and MBSC or model based system engineering where you're trying to talk with folks who might not be cyber experts and then um you know in the end it really serves as a a systems reference architecture and. It allows for you to kind of build out that, uh, you know, those elements and capability and now with you know free tools like build your own um CAD, uh, in a sense you're you're able to go and do that on your own and save those out, uh, also I'll point out the OCSF uh element so. Under the covers, you know, obviously there's that OCSF, um, element that it gives you the ability to, you know, perform hunting operations potentially with, uh, Amazon Security Lake and so, you know, um, there is a free trial for Amazon Security Lake, uh, it's 15 days, um, so it's, you know, there's always an option to, to try and exercise some of these elements. But you know, on the defense side, one thing I wanna point out is it's gained popularity of significant traffic to the website, um, now, uh, Peter watches it quite closely and, um, you know, it's got this growing slack, uh, slack, uh, space for Defend and so there's obviously spaces for engagement there. And equally so, you know, the, the team looks for those contributions back to not only the ontology but also to the code base and I think that um you know it's, it's definitely something if you take a couple of things away, defend and CAD or things to definitely check out. So, engaged, so we're switching gears yet again. So I've talked about attack from the attacker's perspective. I've talked about defend from defender's perspective. And so, uh, we like puns and metaphors, so this damn metaphor works as both and it's true, you know, adversaries are an endless stream. They, um, you stop what you can, but you know, eventually somebody's gonna get in and, uh, from within the cyber resiliency space I always say. Um, the ever present ever adapting adversary that you don't know when they got in, you don't know how, but you still have to operate through and you still have to achieve business or mission so as a result. You know, understanding that these things, this is, uh, uh, you know, something that you need to keep in mind, but luckily there's some, uh, some vulnerabilities to, to adversaries, uh, plans, and that is that they follow a path of least resistance oftentimes so you know, understand. You can channel them away from your key or critical assets, crown jewels and maybe even channel them towards um places where you have better telemetry, better um you know uh uh censoring, and therefore you're driving them to uh a space where you can uh interact more that becomes somewhat key. You make their job more difficult and um you know slow and limit the impact that you have and also get information from them early. And so giving yourself every opportunity to find them, find them early, find them often and planning trip wires along the way, um, of those likely paths really gives you uh a a different advantage and I'll talk uh talk about that, uh, a little bit more. So from the um you know kind of the the basis of our adversarial engagement, what do you mean? Well, cyber denial is behavior to can steal facts and fictions to create ambiguity to adversaries so that they don't understand what is real and what is not where cyber deception. Is defenders' behavior to reveal facts, fictions, and actively create reinforce the adversaries' perceptions, cognitions and beliefs. So what's interesting is these two things form the foundation for adversary engagement. And I, I, I leave it to you like this, um, oftentimes one of my colleagues, uh, Doctor Sambar will get up and tell stories about, hey, adversary engagement, you, you know, understanding that if you always tell the truth, then that's, you know, that's going to be somewhat of an issue but if you lie you tell the truth a couple of times to your ad. you know, let them see a particular um end point is connected. Let them see a particular account is uh in play and then you start lying to them adversaries will, uh, you know, switch gears and say, hey, I, I now believe this element and I want to believe. So you're changing their perceptions based on what you reveal as fact or fiction. And start to shape kind of the battlefield for where where they will operate and that's really where strategic planning and adversary engagement comes into play shaping that um the planning and analysis to shape your um next steps so let's look at that so um. The idea is that you're looking to expose malicious activities earlier rapidly and earlier you're looking to elicit those timely attacks, uh, surface relevant elements and do that in terms of CTI. So in terms of, you know, an adversary that might be, uh, you know, you, you have an idea early what they're doing and then later in their attack life cycle you have an idea what they likely will be doing. And then you're looking to negatively affect the elements um by driving up their costs and I, I actually look at it as a project plan uh from the adversary so project plans, uh, you, you have the ability if you refer back to the PMIs iron triangle, you have the ability to potentially mess with scope, cost, quality, and time. And interestingly enough, uh, you know, you know, cyber, uh, deception and cyber, um, uh, denial is about that you're kind of looking to expand the scope of what they have to shoot at. You're looking to elongate the time it takes for them to understand what is present, eviscerate the quality of the data that they dump. And then also um you know uh uh up the costs because they might need to bring in new tools they might need to validate information they've dumped, so. If you don't do anything early in the attack life cycle before boom, unfortunately that means everything you've told them is true, and they have clear line of sight and picture of all the things that they have the ability to shoot at, whereas if you inject some element of non-truths in the mix with um adversarial engagement you get the advantage across the entire attack life cycle from before boom to um. Boom and after boom in order to not only get the information and tactics that might be in play but also to understand post boom you know what you're gonna need for incident response and so forth but you, you know, obviously not giving up throughout the entire attack life cycle so that's really what you're looking to do is create that knowledge of the threat landscape and then degrade adversaries discovery overall. So let's dive into the engaged framework. So I, I throw this out there. It's part of the, um, you know, the starter kit with, uh, on the engaged website, but there's the steps. There's the steps from 1 through 6 and then 7, and then, um, understand 8 through 10. Now I will throw this out there that everybody wants to jump to operate. It's a fun place, no doubt, but that's not, uh, that's not to your advantage. I'll tell you that prepare is most important. So bringing yourself through 1 in 6 and preparing is key because otherwise what happens and this happens sometimes with folks that go down the adversary engagement route is hey I've, you know, jumped to operate and unfortunately I haven't got the right folks in mind. I haven't um really defined what my goal would be. And so as a result they sometimes get kicked out of ever doing an adversary engagement again based on failing not to prepare so I throw it out there that you need to prepare and you need to do so thoroughly and then obviously get through operate, and I'll talk about that in a second and then get to understand. But at the high level, so I've talked about, you know, the uh uh the construct of preparing, but going and operating, there's things that are kind of familiar in here folks might, you know, recognize as part of, uh, deception or adversary engagement operations things like lures, things like personas, things like pocket litter, um, look seeking to expose, effect, illicit, those are things that you know it's, it's great to understand. That how to do each one of those things there's, you know, uh, tools that can help you but there's also live off the land type techniques and um so you'll probably see more about this in the future. This is live off the land from uh a you know, deception perspective or adversary engagement perspective where you're using things that are already present on an end point that um you know might be key. So what does that what does that really help you to do? Well, in the end, um, you're looking so that when an adversary performs a particular or specific action that you're looking to see what that vulnerability to the action is like I said to you before, if you tell them the truth all the time then their their line of sight is perfect and if you don't and you start to uh you know kind of engage in. The uh element of um adversarial engagement then you know that it's susceptible to manipulation and therefore uh should be you know one of those things that you engage as a defender to take advantage of as a defensive purpose and in this case, you know, we, we take, you know, remote system discovery so you see what systems are uh connected to a system. And if, as I said to you before, if you don't lie to them, then everything is perfect and then when adversaries, when you do lie to them, when adversaries interact with that information through lures, then you've obviously um created that um that friction that noise you see them early, you see them uh more often and you might actually influence in some ways they might bug out so in that sense you still potentially win. So as a result that's that's where um engagement with real adversary behavior comes in so as part of that adversarial engagement has the potential to be a game changer um you know I've, I've been, uh, doing cyber deception work since around 2014, um, you know, dealing with tools that sit in that space, and it, it is a game changer sometimes you can shift. Uh, your investments that would be in other tools that are really kind of focused on, um, you know, the, uh, post bang scenarios and shift those costs to the other places within an organization and that makes it so that you can drive adversaries or drive them out in some cases, but we need, you know, folks to kind of uh prove out that value in their own spaces and so you know getting folks to understand and test that value proposition is key. And you know, engage and the engage uh planner and uh uh you know the things that are out there are really meant um to kind of pull together and start that conversation and we need those you know you folks to keep that conversation going so. I bring this to all right I've talked about um mutter attack. I've talked about mutter defend. I've talked about mutter engage so um there's one thing that kind of sits in the very middle here and it's uh you know I sit on the cyber resiliency team so anticipate, withstand, recover and adapt. I also help with each of the other three frameworks, but as a result I would say that cyber resiliency actually sits in the middle. The attacker is looking to overcome your defenses, anticipate your defenses. They're looking to withstand and recover quickly. They're looking to adapt. Um, and you know, make their next round, uh, more effective. So as a result, um, cyber resilience, even if the attacker doesn't realize it, they're using it. The defender obviously we just talked about that and engage, we're looking to, um, take advantage of the disadvantages that the attacker has, um, when told, you know, truth and lies. So as a result, um, I'd say cyber resiliency sits in the middle anticipate will stand and recover and adapt and. I help um with the CEF navigator as part of uh the cyber resiliency engineering framework and some of the work that that goes in that space but for this uh discussion um you know we're we're, you know, we're talking about what can be done, uh, with the threat catalog for AWS and so. Um, we've done some partnered, uh, research, created, uh, uh, the, you know, the, uh, uh, TPC for AWS, and that's what you see here with the QR code. It can be used as a, a reference to identify, uh, tactics relevance to AWS and used by your organization also. Um, provide ways to tune those detection methodologies and display relevant, uh, mitigation configurations and so I, uh, you know, have this up here, get the QR code, take a look, and now I will turn it over to Shahar. Thank you so much, Shane. uh, curious about a quick show of hands, how many of you have heard about Guard duty in the past? OK, I see lots of hands, which is great. Not all the hands, so hope to fix that after today, um, and how many of you are using, uh, guard duty in your, uh, environment? OK, about the same conclusion. Great, so I'll do a quick crash course on what guard duty is, how it can help you better secure your AWS environment, and we'll talk about the connection between MITR and guard duty and how it can help you reach better outcomes by the mapping that guard duty has to MITR framework. So GuardUT is the threat detection service for AWS environments. The metaphor I like to think about GuardTs is as the canary for your cloud environment. If something goes wrong. Carduty will alert you that there is some suspicious activity in a specific account or workload that you should take a look at and if something is really bad, we'll uh make sure to alert you in a more prominent manner. It's a fully managed service and which means that we enable one click enablement across your entire organization or in a specific account if you would like. You don't need to set up any infrastructure, enable any logs, um, log sources, or really do anything to make guard duty up and running except for enabling the service itself and once it's up, GuardduT continuously monitors your AWS environment across different data sources that we will address really soon. And the way we do it is by combining both machine learning algorithms, stateless rules, and state for rules that are continuously tuned and improved by our unique visibility into the AWS red landscape to ensure that we continuously. Detect both common threats as well as emerging threats as attackers continue to adapt their techniques and that really ties to a lot of what Shane discussed earlier where we have let's say the tactics don't change materially uh or at least not often, and the techniques change. Let's say, but not super frequently, but the specific sub techniques and procedures we actually see a lot of um it's quote innovation in a way by the way, attackers always try to undermine and go around existing detection tools and therefore we always keep track and invest a lot of resources to make sure we detect these emerging techniques as well. And part of the fact that enables us to stay on track on what is emerging and new and novel is very extensive threat intelligence that we have both threat intelligence that is produced by AWS as well as threat intelligence that we get from third party partners. So a bit about the scale and visibility we have. One of the things that we use to be able to detect suspicious and malicious domains oftentimes weeks before we see them within other uh threat intelligence providers is called MFFRA. MFRA is one of the largest neural networks in the world, and we really use it to map. Network traffic that we observe as AWS to detect domains that could look more suspicious and then we use various internal techniques to validate whether they are indeed suspicious or in fact malicious. Uh, another resource that we have that is also AWS internal is called Medpot. Uh, there is actually a great blog about Medpot. I would recommend if you would just Google AWS blog Medpot, you can learn a lot more about it, but it's really a global network of honeypots that allows us to detect malicious activity and new ways that attackers are trying to either. Perform recons or more impactful activities in AWS environments. And lastly, a bit about the scale of that Guti operates. Guardity is used by over 95% of the top 2000 customers of AWS, uh, used by tens of thousands of customers across virtually every industry, geography. And what that allows us is very big visibility into activity in AWS environments so just to give a demonstration about the scale we operate, um, last prime day. And maybe some of you were responsible to part of that, uh, activity. I know I bought a lot of things last Prime Day, uh, Guardian to monitor nearly 6 trillion events per hour, and that is an increase of over 30% compared to last year. So we really operate on an unprecedented scale that allows us to then take that visibility and create better detections on your behalf to for you to improve your cloud security. So let's dive a bit deeper on what exactly do we monitor and how it works. Today Guard DT monitors multiple log sources. When we started guard duty, and that is what is foundational guard duty that you get to enable Guard DT itself, we monitor cloud trail, DNS logs, and uh VPC flow logs that allows us visibility into the foundational detection. It's really the control plan activity in the cloud and network activity. But then we continue to expand our visibility over the past 5 years really and now we cover. Um, S3 data events, EKS audit logs, we have, uh, an on-host sensor that you can deploy in EC2 ECS Firegate and EKS, and, uh, we cover lambda, uh, flow logs as well as malware scanning. So a lot of different things as you can gather from this and we'll cover more about the specific capabilities in a moment. And the way the mental framework that I like to work with customers on because you have a lot of options and then the question is OK so what should I actually use right? because. It's the well the recommendation and the easiest thing to do is to enable everything but if you want to enable kind of like one step at a time and want to think through what should they have in place, then I would typically recommend thinking about the infrastructure you have deployed in your cloud environment and work from there. So if for example you know we use mainly um EC2s and S3. It's kind of like the more classic cloud infrastructure and you can enable foundational guard duty and S3 protection and we'll go over the names of the protection plans. But if you know for example you have lambda deployed in your cloud environment as well, then you might want to think about lambda protection. So this kind of like matching infrastructure with the security protection is how I like to to think about it. And once it's enabled these different um protection plans, we get these logs straight from the source which means you don't need to enable anything on your end you don't need for example to enable VPC flow logs for us to process VPC flow logs which allows you to save on cost and storage as well as just simplify the deployment, obviously. And we use the combination of the fret intelligence I mentioned before, as well as algorithms we develop in-house to be able to detect suspicious and malicious activity. This algorithm produced over 175 types of findings where each finding type corresponds to a specific threat really. So for example, one finding type would be um crypto mining activity or data exfiltration and free. One unique advantage that you get by using guard duty is that no one can interrupt the monitoring since we're getting the logs straight from the source, for example, S3 data events, you first, you don't need to enable S3 data events to be able to get the monitoring, but also even if attacker gains access to your cloud environment. If they turn off or disable S3 data events, we will still get them, process them and alert you on any malicious activity because again we get threats from the source. And once the findings are created, they can be consumed in the Guard duty console, AWS security hub, which is our sign up offering, Amazon Detective for investigation, and if you want to forward it to your other security tools you can use eventbridge for more um. Event driven architecture or export the findings to S3 and then pull the findings from there. So this is from your perspective and you come to enable guard duty of the different protection plans. This is how it will look like and the log sources that I mentioned are offered as distinct protection plans. So for example, S3 protection helps you detect malicious activity that relates to your S3 bucket, such as data exfiltration or data destruction. Another example is RDS protection. RDS protections allow you to detect primarily brute force attacks where um we observe all the different logging attempts whether they are successful or unsuccessful, and then alert you if for example. There were 100 attempts to log in to a specific RDS instance that all of them failed and then one attempt was successful, for example, and that was done from a new location that typically is not used in that AWS account. Um, and that's obviously something you might want to take a look into. Um, each of these protection plans come with a 30 day free trial so you can test it out, compare it, run, uh, evaluation on the different value propositions that you want to get as a security engineer or security professional and also use a public finding tester that we have that simulates attacks, and we recommend running it in a sandbox account just you know just to be sure. But basically, it spins up infrastructure, conducts activity that simulates an attack, and then uh tears down the infrastructure and that can help you evaluate the different protection plans. And obviously there is also third party uh frameworks that allow you to simulate the tax as well. So just on the uh protection plans I also want to add we have runtime monitoring which allows you to gain more visibility into on host activity that is particularly important if you're using containerized workloads such as EPS or ECS because that additional visibility that is provided by the sensors allows us to detect for example that. If there was a crypto mining activity, which specific container and which process within it triggered that activity and what was the whole process tree that led up to that moment. As well as the container image that was pulled in the case of supply chain attack all into a specific finding, uh, whereas even with the foundational guard in place you will still be alerted that there was some. Most likely crypto mining activity that happened on EC2 instance but you wouldn't be able to discern which specific container triggered it because we're monitoring the VPC flow logs and DNS logs in the case of foundational guard duty. So the way I, I, I'd like to think about it is if you really need and want that additional level of feasibility, the runtime monitoring offering is something good to consider. So I won't go over all the protection plans in detail, but again, the recommendation, uh, from my perspective is to think through the different workloads that you have, the different infrastructure you deploy in your environment and then match it with the different quality protection plans that are applicable to this infrastructure. So what we heard from customers over the past years was initially they wanted more scope of visibility into specific types of attacks. So for example, we added the coverage for EKS both in terms of EKS control plan and then EKS runtime monitoring and to be able to detect attacks in such kind of workloads, but then as we expanded the visibility. What you get is many different types of findings and while most of these findings were applicable are mapped for example to mor framework to help you understand OK this type of finding in car duty what does it translate to in the really universal language of cybersecurity. You still need to triage and investigate many different types of findings and the volume of findings keep increasing because the activity in cloud environments just scales and one thing I never heard from a customer is them telling me, you know what, I actually don't get enough alerts on my security tools, you know, it's just too quiet around here. I just sit here and I don't have anything to do. Uh, it typically is the opposite way around. So what we released last reinvent about 6 months ago. To be able to address the need of customers of understanding how different security alerts relate to each other and which alerts are really the ones that they should evaluate most carefully is called guard duty extended threat detection. This capability is enabled automatically with no additional cost, so for the ones who already raised their hand and said they're using guard duty, you already have that enabled and this capability automatically. Uses AI and ML technology to correlate different activity and put together the puzzle on what is the most pressing and highest confident threats in your cloud environment, so. It will correlate both strong signals which are cordative findings as well as weak signals that are activity that we see on our side but don't send out to you to not overwhelm customers with findings and we'll put it together into a single critical severity attack sequence which is a new type of finding that we released last reinvent. And this attack sequence will contain the full attack chain, all the different activities that we observed in a single timeline, and we'll see it in a moment, and that allows you to focus on these alerts first instead of evaluating the individual events that come in on an ongoing basis. The value from your perspective is that you need to spend less time on the really first level analysis of evaluating each individual finding and trying to figure out how the findings relate to each other and more time focusing on investigating these validated threats and after. Um, it's been 6 months now. Uh, I can tell you that the true positive rate of these types of findings is, is very high. Uh, I can't call the exact number because, you know, it's uh tricky from that perspective, but I would strongly, strongly recommend seriously evaluating every attack sequence that is being created. And um What types of attack sequences we have. Right now we have two types of attack sequences with preferred one coming pretty soon. I would stay tuned for the rest of this week and uh the first one is compromise identity, compromise identity, which is typically a compromise of long term AWS credentials, remains the main initial access attack vector to cloud environments. And the second one is compromised data, data is most often the most important organizational assets that you have in your cloud environment. In the first case of compromise credentials, we will detect a sequence of actions that typically translates to multiple stages in the mor attack framework and put them together into a single finding for you to be able to evaluate and respond to. Uh, similarly in the compromise data finding in that one we are focusing more on data residing in S3. And looking for series of actions that contain evidence to data exfiltration and data destruction, this one is also very applicable for ransomware events. We just don't position it as ransomware we don't because we don't see the claim for ransom. Um, but I would again strongly recommend looking and evaluating these findings, and the third one that might come up fairly soon relates to compromise EKS clusters in your cloud environment, and there we correlate activity from foundational guard duty, S3 protection, EKS with each EKS protection which is um EKS audit logs monitoring. And runtime monitoring which relates to the on hosts activity. To detect a compromise relating to the cluster, so for example. Um, a use case can be a compromise credential that leads to a creation of a new Kubernetti user launching a new privileged container that that is then being used for crypto mining activity and instead of you having to put together 20 different events and understand how they relate to each other, you just get a single finding that already outlates the full timeline of events. So let's take a look at these findings and I, I do apologize that it is a bit small, so I will. Um, talk about what exists there. Uh, the first part of the finding, and this is a compromise credential finding, outlays the different activity that happened in this case we correlated 5 different signals across a multiple hours time frame and. What you can probably can see is that in the summary we already tell you hey we saw multiple uh mor attack tactics used as a part of this event as well as minor attack techniques that we observed in this case, for example, uh modification of cloud logs and data extration. In the middle of the page just under the attack sequence you can see that we outlay the mor tactics that were observed so you can see the attack chain. And then see which activities were already identified and if you click on one of these, it will show you the specific findings that were uh associated with this part of the mor framework. So even if you don't know the exact guardity finding type, you can still easily understand that OK, there was some activity that happened relating to impact or execution, and then I can drill down and see the specific guardity finding that is associated with that stage. And on the right hand side you can see the different um signals that we correlated. Each box is one binding or other weak signal, and on the rightmost side of it we put the tags that correspond to the mor framework mitor attack framework for this activity. And under each activity you can see the exact resources involved with it. Uh, the first one is deletion of objects from S3 for a specific in a specific, uh, S3 bucket, and then you can learn about the specific bucket that that activity related to the credentials that were used to make the API call and uh more details to help you get context. One last thing that we have here. And that's the uh right tab. I don't have a screenshot of it. It's the resources tab. That's a very powerful pivot view because it can help you quickly identify which resources were involved in this attack sequence. So you can see for example the S3 buckets that were compromised, the access key that is likely compromised as well, and then mitigate and focus your response on the specific resources. So thank you all so much for spending your first hour of reinforce with us. We're really grateful for you waking up early in the morning and uh coming to spend this hour with us. Uh, thank you so much. We're gonna stick around here if you have any questions or follow up, and this is our names if you have any follow up as well and have a fantastic reinforce.
